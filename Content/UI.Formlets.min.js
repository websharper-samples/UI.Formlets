function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO;a=self;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Formlets=c.Formlets||{};e=d.Tests=d.Tests||{};f=e.Client=e.Client||{};g=d.Pervasives=d.Pervasives||{};h=d.Formlet=d.Formlet||{};i=b.Operators=b.Operators||{};j=d.Controls=d.Controls||{};k=b.List=b.List||{};l=b.Obj=b.Obj||{};m=h.Builder=h.Builder||{};n=b.Seq=b.Seq||{};o=b.Utils=b.Utils||{};p=f.Country=f.Country||{};q=c.Doc=c.Doc||{};r=b.JavaScript=b.JavaScript||{};s=r.Pervasives=r.Pervasives||{};t=r.JS=r.JS||{};u=d.Layout=d.Layout||{};v=c.Key=c.Key||{};w=c.Var=c.Var||{};x=d.Validation=d.Validation||{};y=c.ListModel=c.ListModel||{};z=c.View=c.View||{};A=d.Result=d.Result||{};B=k.T=k.T||{};C=b.Arrays=b.Arrays||{};D=a.StartupCode$WebSharper_UI_Formlets$Formlets=a.StartupCode$WebSharper_UI_Formlets$Formlets||{};E=c.Submitter=c.Submitter||{};F=c.AttrProxy=c.AttrProxy||{};G=c.AttrModule=c.AttrModule||{};H=b.Enumerator=b.Enumerator||{};I=H.T=H.T||{};J=b.Unchecked=b.Unchecked||{};K=c.Array=c.Array||{};L=b.Option=b.Option||{};M=c.Client=c.Client||{};N=M.Templates=M.Templates||{};O=c.Abbrev=c.Abbrev||{};P=O.Fresh=O.Fresh||{};Q=c.Var$1=c.Var$1||{};R=c.Storage=c.Storage||{};S=c.Snap=c.Snap||{};T=b.Collections=b.Collections||{};U=T.Dictionary=T.Dictionary||{};V=c.DomUtility=c.DomUtility||{};W=c.Attrs=c.Attrs||{};X=a.Object;Y=a.EventTarget;Z=a.Node;_0=R.ArrayStorage=R.ArrayStorage||{};_1=c.ConcreteVar=c.ConcreteVar||{};_2=T.DictionaryUtil=T.DictionaryUtil||{};_3=c.Elt=c.Elt||{};_4=c.DynamicAttrNode=c.DynamicAttrNode||{};_5=c.DocElemNode=c.DocElemNode||{};_6=a.CharacterData;_7=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};_8=T.HashSet=T.HashSet||{};_9=a.WindowOrWorkerGlobalScope;_=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};$=c.Docs=c.Docs||{};ba=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bb=c.Updates=c.Updates||{};bc=M.Attrs=M.Attrs||{};bd=bc.Dyn=bc.Dyn||{};be=N.Prepare=N.Prepare||{};bf=b.Slice=b.Slice||{};bg=T.KeyCollection=T.KeyCollection||{};bh=c.An=c.An||{};bi=M.Settings=M.Settings||{};bj=O.Mailbox=O.Mailbox||{};bk=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bl=b.Strings=b.Strings||{};bm=M.Docs=M.Docs||{};bn=bm.RunState=bm.RunState||{};bo=bm.NodeSet=bm.NodeSet||{};bp=c.Anims=c.Anims||{};bq=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};br=b.Queue=b.Queue||{};bs=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bt=b.Concurrency=b.Concurrency||{};bu=c.AppendList=c.AppendList||{};bv=T.HashSetUtil=T.HashSetUtil||{};bw=c.Easing=c.Easing||{};bx=bt.AsyncBody=bt.AsyncBody||{};by=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bz=bt.CT=bt.CT||{};bA=O.HashSet=O.HashSet||{};bB=bt.Scheduler=bt.Scheduler||{};bC=b.CancellationTokenSource=b.CancellationTokenSource||{};bD=bm.DomNodes=bm.DomNodes||{};bE=a.Error;bF=b.OperationCanceledException=b.OperationCanceledException||{};bG=b.Lazy=b.Lazy||{};bH=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bI=b.LazyExtensionsProxy=b.LazyExtensionsProxy||{};bJ=bI.LazyRecord=bI.LazyRecord||{};bK=a.console;bL=a.IntelliFactory;bM=bL&&bL.Runtime;bN=a.jQuery;bO=a.Date;f.Main=function(){var bP,bQ,bR;function bS(bU){return bU[0];}function bT(bU){return bU[0];}bK.log("Running JavaScript Entry Point..");bP=h.ManyWithModel(y.Create(function(bU){return bT(bS(bU));},k.ofArray([[[v.Fresh(),"b"],[true,"HU"]],[[v.Fresh(),"d"],[false,"FR"]]])),function(){return[[v.Fresh(),"b"],[true,"HU"]];},function(bU){var bV;function bW(b2,b3){return function(b4){return[[b2[0],b4],b3];};}function bX(b2){return b2[0];}function bY(b2){return b2[1];}function bZ(b2,b3){return function(b4){return[b2,[b4,b3[1]]];};}function b0(b2){return b2[1];}function b1(b2){return b2[0];}return g.op_LessMultiplyGreater(g.op_LessMultiplyGreater(h.Return(function(b2){return function(b3){return[b2,b3[0],b3[1]];};}),h.WithTextLabel("First field:",x.IsNotEmpty("Please enter a first field value",j.InputVar(Q.Lens(bU,function(b2){return bY(bX(b2));},function(b2,b3){return(function(b4){return bW(b4[0],b4[1]);}(b2))(b3);}))))),h.WithTextLabel("Second field:",h.Horizontal((bV=h.Do(),bV.Bind(j.CheckBoxVar(Q.Lens(bU,function(b2){return b1(b0(b2));},function(b2,b3){return(function(b4){return bZ(b4[0],b4[1]);}(b2))(b3);})),function(b2){function b3(b6,b7){return function(b8){return[b6,[b7[0],b8]];};}function b4(b6){return b6[1];}function b5(b6){return b6[1];}return bV.Bind(h.Horizontal(((b2?function(b6){return function(b7){return j.SelectVar(b6,b7);};}:function(b6){return function(b7){return j.RadioVar(b6,b7);};})(Q.Lens(bU,function(b6){return b5(b4(b6));},function(b6,b7){return(function(b8){return b3(b8[0],b8[1]);}(b6))(b7);})))(k.ofArray([["HU","Hungary"],["FR","France"]]))),function(b6){return bV.Return([b2,b6]);});})))));});g.op_LessMultiplyGreater(g.op_LessMultiplyGreater(h.Return(function(bU){var bV,bW;bV=bU[0];bW=bU[1];return function(bX){return[bV,bW,bX[0],bX[1]];};}),h.Horizontal(g.op_LessMultiplyGreater(g.op_LessMultiplyGreater(h.Return(function(bU){return function(bV){return[bU,bV];};}),j.Input("a")),j.Input("b")))),h.Horizontal(g.op_LessMultiplyGreater(g.op_LessMultiplyGreater(h.Return(function(bU){return function(bV){return[bU,bV];};}),j.CheckBox(true)),j.Select("HU",k.ofArray([["HU","Hungary"],["FR","France"]])))));bQ=h.RunWithLayout(u.Table,function(){self.foo=void 0;},h.WithFormContainer((bR=h.Do(),bR.Bind(h.WithSubmit("Submit",bP),function(bU){return bR.ReturnFrom(h.OfDoc(function(){function bV(bW,bX,bY){bK.log(bY);return q.Element("p",[],[q.TextNode(((((bM.Curried(function(bZ,b0,b1,b2){return bZ(o.toSafe(b0)+" "+a.String(b1)+" "+o.toSafe(b2));},4))(a.id))(bW))(bX))(p.ToString(bY)))]);}return q.Concat(n.map(function(bW){return bV(bW[0],bW[1],bW[2]);},bU));}));}))));N.LoadLocalTemplates("");q.RunById("main",bQ);};g.op_LessMultiplyGreater=function(bP,bQ){var bR,bS;bR=bP.$0;bS=bQ.$0;return new h({$:0,$0:function(){var bT,bU;bT=bR();bU=bS();return{View:z.Map2(A.Apply,bT.View,bU.View),Layout:k.append(bU.Layout,bT.Layout)};}});};h.Return=function(bP){return new h({$:0,$0:function(){return{View:z.Const({$:0,$0:bP}),Layout:B.Empty};}});};h.Horizontal=function(bP){var bQ;bQ=bP.$0;return new h({$:0,$0:function(){var bR;function bS(bT){var bU,bV;return bT.$==1?bT.$1.$==0?(bU=bT.$0,k.ofArray([(bV=bU.Shape,bV.$==3?u.New({$:2,$0:bV.$0},bU.Label):bV.$==1?u.New({$:1,$0:z.Map(bS,bV.$0)},bU.Label):bU)])):k.ofArray([u.New({$:2,$0:bT},null)]):B.Empty;}bR=bQ();return{View:bR.View,Layout:bS(bR.Layout)};}});};h.Do=function(){D.$cctor();return D.Do;};h.WithSubmit=function(bP,bQ){var bR;bR=bQ.$0;return new h({$:0,$0:function(){var bS,bT;bS=bR();bT=new E.New(bS.View,{$:1,$0:B.Empty});return{View:bT.view,Layout:new B({$:1,$0:u.Item(q.Element("input",k.ofArray([F.Create("type","button"),F.Create("value",bP),G.Class("submitButton"),G.Handler("click",function(){return function(){return bT.Trigger();};}),G.DynamicPred("disabled",z.Map(A.IsFailure,bT.input),z.Const("disabled"))]),B.Empty)),$1:bS.Layout})};}});};h.OfDoc=function(bP){return new h({$:0,$0:function(){return{View:z.Const({$:0,$0:null}),Layout:k.ofArray([u.Item(bP())])};}});};h.WithFormContainer=function(bP){return h.WrapLayout(function(bQ){return q.Element("form",k.ofArray([G.Class("formlet")]),k.ofArray([bQ]));},bP);};h.RunWithLayout=function(bP,bQ,bR){var bS,bT;bS=bR.$0();bT=q.BindView(function(bU){bU.$==1?void 0:bQ(bU.$0);return q.get_Empty();},bS.View);return q.Append(bP(u.OfList(bS.Layout)),bT);};h.ManyWithModel=function(bP,bQ,bR){return new h({$:0,$0:function(){var bS,bT,bU,bV,bW,bX,bY;function bZ(b4){return b4[1];}function b0(b4){function b5(b6){return[b6];}return z.Map(function(b6){return A.Map(b5,b6);},b4.View);}function b1(b4,b5){return z.Map2(A.Append,b4,b5);}function b2(b4){return b4.Layout;}function b3(b4,b5){return k.append(b5,b4);}bS=y.Create(function(b4){return b4[0];},B.Empty);bP.Iter(function(b4){var b5;b5=bP.key(b4);bS.Append([b5,(bR(bP.Lens(b5)).get_Data())()]);});bT=z.Map(function(b4){var b5,b6,b7,b8,b9;b5=H.Get(b4);try{while(b5.MoveNext()){b6=bP.key(b5.Current());!bS.ContainsKey(b6)?bS.Append([b6,(bR(bP.Lens(b6)).get_Data())()]):void 0;}}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}b7=bS["var"].Get();b8=H.Get(b7);try{while(b8.MoveNext()){b9=(b8.Current())[0];!bP.ContainsKey(b9)?bS.RemoveByKey(b9):void 0;}}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}return q.get_Empty();},bP.v);bU=z.Map((bV=function(b4){return n.map(bZ,b4);},function(b4){return C.ofSeq(bV(b4));}),bS.v);return{View:z.Bind((bW=z.Const({$:0,$0:[]}),function(b4){return K.MapTreeReduce(b0,bW,b1,b4);}),bU),Layout:k.ofArray([u.Item((bX=q.Element("div",k.ofArray([G.Class("addIcon"),G.Handler("click",function(){return function(){return bP.Append(bQ());};})]),B.Empty),q.Append(q.EmbedView(bT),bX))),u.Varying(z.Map((bY=B.Empty,function(b4){return K.MapTreeReduce(b2,bY,b3,b4);}),bU))])};}});};h.WithTextLabel=function(bP,bQ){return h.MapLayout(function(bR){var bS,bT;bS={$:1,$0:q.Element("label",B.Empty,k.ofArray([q.TextNode(bP)]))};return(bR.$==1?bR.$1.$==0?(bT=bR.$0,true):(bT=bR,false):(bT=bR,false))?k.ofArray([u.New(bT.Shape,bS)]):k.ofArray([u.New({$:3,$0:bT},bS)]);},bQ);};h.Bind=function(bP,bQ){var bR;bR=bP.$0;return new h({$:0,$0:function(){var bS,bT;function bU(bV){return(bQ(bV).get_Data())();}bS=bR();bT=z.Map(function(bV){return A.Map(bU,bV);},bS.View);return{View:z.Bind(function(bV){return bV.$==1?z.Const({$:1,$0:bV.$0}):bV.$0.View;},bT),Layout:new B({$:1,$0:u.Varying(z.Map(function(bV){return bV.$==0?bV.$0.Layout:B.Empty;},bT)),$1:bS.Layout})};}});};h.WrapLayout=function(bP,bQ){return h.MapLayout(function(bR){return k.ofArray([u.Wrap(bP,u.OfList(bR))]);},bQ);};h.MapLayout=function(bP,bQ){var bR;bR=bQ.$0;return new h({$:0,$0:function(){var bS;bS=bR();return{View:bS.View,Layout:bP(bS.Layout)};}});};h.MapToResult=function(bP,bQ){return h.MapResult(function(bR){return A.Bind(bP,bR);},bQ);};h.MapResult=function(bP,bQ){var bR;bR=bQ.$0;return new h({$:0,$0:function(){var bS;bS=bR();return{View:z.Map(bP,bS.View),Layout:bS.Layout};}});};i.FailWith=function(bP){throw new bE(bP);};i.KeyValue=function(bP){return[bP.K,bP.V];};j.Input=function(bP){return j["InputInit'"](bP,j.InputLayout);};j.CheckBox=function(bP){return j["InputInit'"](bP,j.CheckBoxLayout);};j.Select=function(bP,bQ){return j["Select'"](function(bR){return j["InputInit'"](bP,bR);},bQ);};j.InputVar=function(bP){return j["InputVar'"](bP,j.InputLayout);};j.CheckBoxVar=function(bP){return j["InputVar'"](bP,j.CheckBoxLayout);};j.SelectVar=function(bP,bQ){return j["Select'"](function(bR){return j["InputVar'"](bP,bR);},bQ);};j.RadioVar=function(bP,bQ){return j["Radio'"](function(){return bP;},bQ);};j["InputInit'"]=function(bP,bQ){return j["Input'"](function(){return Q.Create$1(bP);},bQ);};j.InputLayout=function(bP){return q.Input([G.Class("inputText")],bP);};j.CheckBoxLayout=function(bP){return q.CheckBox([G.Class("inputCheckbox")],bP);};j["Select'"]=function(bP,bQ){var bR,bS,bT;function bU(bW,bX){bR.set_Item(bW,bX);return bW;}function bV(bW){return bR.get_Item(bW);}bR=new U.New$5();bS=k.map(function(bW){return bU(bW[0],bW[1]);},bQ);return bP((bT=B.Empty,function(bW){return q.Select(bT,bV,bS,bW);}));};j["InputVar'"]=function(bP,bQ){return j["Input'"](function(){return bP;},bQ);};j["Radio'"]=function(bP,bQ){return new h({$:0,$0:function(){var bR;function bS(bT,bU){return u.Item(q.Element("label",B.Empty,k.ofArray([q.Radio([G.Class("inputRadio")],bT,bR),q.TextNode(bU)])));}bR=bP();return{View:z.Map(function(bT){return{$:0,$0:bT};},bR.get_View()),Layout:k.map(function(bT){return bS(bT[0],bT[1]);},k.rev(bQ))};}});};j["Input'"]=function(bP,bQ){return new h({$:0,$0:function(){var bR;bR=bP();return{View:z.Map(function(bS){return{$:0,$0:bS};},bR.get_View()),Layout:k.ofArray([u.Item(bQ(bR))])};}});};k.ofArray=function(bP){var bQ,bR,bS;bQ=B.Empty;for(bR=C.length(bP)-1,bS=0;bR>=bS;bR--)bQ=new B({$:1,$0:C.get(bP,bR),$1:bQ});return bQ;};k.rev=function(bP){var bQ,bR;bQ=B.Empty;bR=bP;while(bR.$==1){bQ=new B({$:1,$0:bR.$0,$1:bQ});bR=bR.$1;}return bQ;};k.collect=function(bP,bQ){return k.ofSeq(n.collect(bP,bQ));};k.append=function(bP,bQ){var bR,bS,bT,bU,bV;if(bP.$==0)return bQ;else if(bQ.$==0)return bP;else{bU=new B({$:1});bR=bU;bS=bP;bT=true;while(bT){bR.$0=bS.$0;bS=bS.$1;bS.$==0?bT=false:bR=(bV=new B({$:1}),bR.$1=bV,bV);}bR.$1=bQ;return bU;}};k.map=function(bP,bQ){var bR,bS,bT,bU,bV;if(bQ.$==0)return bQ;else{bU=new B({$:1});bR=bU;bS=bQ;bT=true;while(bT){bR.$0=bP(bS.$0);bS=bS.$1;bS.$==0?bT=false:bR=(bV=new B({$:1}),bR.$1=bV,bV);}bR.$1=B.Empty;return bU;}};k.ofSeq=function(bP){var bQ,bR,bS,bT,bU,bV;if(bP instanceof B)return bP;else if(bP instanceof a.Array)return k.ofArray(bP);else{bQ=H.Get(bP);try{bS=bQ.MoveNext();if(!bS)bR=B.Empty;else{bU=new B({$:1});bT=bU;while(bS){bT.$0=bQ.Current();bQ.MoveNext()?bT=(bV=new B({$:1}),bT.$1=bV,bV):bS=false;}bT.$1=B.Empty;bR=bU;}return bR;}finally{if(typeof bQ=="object"&&"Dispose"in bQ)bQ.Dispose();}}};k.mapi=function(bP,bQ){var bR,bS,bT,bU,bV,bW;if(bQ.$==0)return bQ;else{bV=new B({$:1});bR=bV;bS=bQ;bT=0;bU=true;while(bU){bR.$0=bP(bT,bS.$0);bS=bS.$1;bS.$==0?bU=false:(bR=(bW=new B({$:1}),bR.$1=bW,bW),bT=bT+1);}bR.$1=B.Empty;return bV;}};k.head=function(bP){return bP.$==1?bP.$0:k.listEmpty();};k.tail=function(bP){return bP.$==1?bP.$1:k.listEmpty();};k.listEmpty=function(){return i.FailWith("The input list was empty.");};l=b.Obj=bM.Class({Equals:function(bP){return this===bP;},GetHashCode:function(){return -1;}},null,l);l.New=bM.Ctor(function(){},l);m=h.Builder=bM.Class({Bind:function(bP,bQ){return h.Bind(bP,bQ);},ReturnFrom:a.id,Return:function(bP){return h.Return(bP);}},l,m);m.New=bM.Ctor(function(){l.New.call(this);},m);n.map=function(bP,bQ){return{GetEnumerator:function(){var bR;bR=H.Get(bQ);return new I.New(null,null,function(bS){return bR.MoveNext()&&(bS.c=bP(bR.Current()),true);},function(){bR.Dispose();});}};};n.collect=function(bP,bQ){return n.concat(n.map(bP,bQ));};n.append=function(bP,bQ){return{GetEnumerator:function(){var bR,bS;bR=H.Get(bP);bS=[true];return new I.New(bR,null,function(bT){var bU;return bT.s.MoveNext()?(bT.c=bT.s.Current(),true):(bU=bT.s,!J.Equals(bU,null)?bU.Dispose():void 0,bT.s=null,bS[0]&&(bS[0]=false,bT.s=H.Get(bQ),bT.s.MoveNext()?(bT.c=bT.s.Current(),true):(bT.s.Dispose(),bT.s=null,false)));},function(bT){var bU;bU=bT.s;!J.Equals(bU,null)?bU.Dispose():void 0;});}};};n.concat=function(bP){return{GetEnumerator:function(){var bQ;bQ=H.Get(bP);return new I.New(null,null,function(bR){var bS;while(true){bS=bR.s;if(J.Equals(bS,null)){if(bQ.MoveNext()){bR.s=H.Get(bQ.Current());bR=bR;}else{bQ.Dispose();return false;}}else if(bS.MoveNext()){bR.c=bS.Current();return true;}else{bR.Dispose();bR.s=null;bR=bR;}}},function(bR){var bS;bS=bR.s;!J.Equals(bS,null)?bS.Dispose():void 0;!J.Equals(bQ,null)?bQ.Dispose():void 0;});}};};n.head=function(bP){var bQ;bQ=H.Get(bP);try{return bQ.MoveNext()?bQ.Current():n.insufficient();}finally{if(typeof bQ=="object"&&"Dispose"in bQ)bQ.Dispose();}};n.distinctBy=function(bP,bQ){return{GetEnumerator:function(){var bR,bS;bR=H.Get(bQ);bS=new _8.New$3();return new I.New(null,null,function(bT){var bU,bV;if(bR.MoveNext()){bU=bR.Current();bV=bS.Add(bP(bU));while(!bV&&bR.MoveNext()){bU=bR.Current();bV=bS.Add(bP(bU));}return bV&&(bT.c=bU,true);}else return false;},function(){bR.Dispose();});}};};n.fold=function(bP,bQ,bR){var bS,bT;bS=bQ;bT=H.Get(bR);try{while(bT.MoveNext())bS=bP(bS,bT.Current());return bS;}finally{if(typeof bT=="object"&&"Dispose"in bT)bT.Dispose();}};n.findIndex=function(bP,bQ){var bR;bR=n.tryFindIndex(bP,bQ);return bR==null?i.FailWith("KeyNotFoundException"):bR.$0;};n.iter=function(bP,bQ){var bR;bR=H.Get(bQ);try{while(bR.MoveNext())bP(bR.Current());}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}};n.tryFindIndex=function(bP,bQ){var bR,bS,bT;bR=H.Get(bQ);try{bS=true;bT=0;while(bS&&bR.MoveNext())if(bP(bR.Current()))bS=false;else bT=bT+1;return bS?null:{$:1,$0:bT};}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}};n.nth=function(bP,bQ){var bR,bS;if(bP<0)i.FailWith("negative index requested");bR=-1;bS=H.Get(bQ);try{while(bR<bP){!bS.MoveNext()?n.insufficient():void 0;bR=bR+1;}return bS.Current();}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}};n.max=function(bP){var bQ,bR,bS;bQ=H.Get(bP);try{if(!bQ.MoveNext())n.seqEmpty();bR=bQ.Current();while(bQ.MoveNext()){bS=bQ.Current();J.Compare(bS,bR)===1?bR=bS:void 0;}return bR;}finally{if(typeof bQ=="object"&&"Dispose"in bQ)bQ.Dispose();}};n.seqEmpty=function(){return i.FailWith("The input sequence was empty.");};o.toSafe=function(bP){return bP==null?"":bP;};p.ToString=function(bP){return bP=="FR"?"FR":"HU";};q=c.Doc=bM.Class({},l,q);q.Concat=function(bP){var bQ;bQ=K.ofSeqNonCopying(bP);return K.TreeReduce(q.get_Empty(),q.Append,bQ);};q.Element=function(bP,bQ,bR){var bS,bT;bS=F.Concat(bQ);bT=q.Concat(bR);return _3.New(V.CreateElement(bP),bS,bT);};q.TextNode=function(bP){return q.Mk({$:5,$0:V.CreateText(bP)},z.Const());};q.Append=function(bP,bQ){return q.Mk({$:0,$0:bP.docNode,$1:bQ.docNode},z.Map2Unit(bP.updates,bQ.updates));};q.get_Empty=function(){return q.Mk(null,z.Const());};q.RunById=function(bP,bQ){var bR;bR=V.Doc().getElementById(bP);J.Equals(bR,null)?i.FailWith("invalid id: "+bP):q.Run(bR,bQ);};q.Mk=function(bP,bQ){return new q.New(bP,bQ);};q.BindView=function(bP,bQ){return q.EmbedView(z.Map(bP,bQ));};q.Run=function(bP,bQ){$.LinkElement(bP,bQ.docNode);q.RunInPlace(false,bP,bQ);};q.EmbedView=function(bP){var bQ;bQ=$.CreateEmbedNode();return q.Mk({$:2,$0:bQ},z.Map(a.ignore,z.Bind(function(bR){$.UpdateEmbedNode(bQ,bR.docNode);return bR.updates;},bP)));};q.Input=function(bP,bQ){return q.InputInternal("input",function(){return n.append(bP,[G.Value(bQ)]);});};q.CheckBox=function(bP,bQ){return q.InputInternal("input",function(){return n.append(bP,[F.Create("type","checkbox"),G.Checked(bQ)]);});};q.Select=function(bP,bQ,bR,bS){return q.SelectImpl(bP,bQ,function(bT){bT[0]=bR;return q.Concat(k.mapi(function(bU,bV){return q.Element("option",k.ofArray([F.Create("value",a.String(bU))]),k.ofArray([q.TextNode(bQ(bV))]));},bR));},bS);};q.RunInPlace=function(bP,bQ,bR){var bS;bS=$.CreateRunState(bQ,bR.docNode);z.Sink(bh.get_UseAnimations()||bi.BatchUpdatesEnabled()?bj.StartProcessor($.PerformAnimatedUpdate(bP,bS,bR.docNode)):function(){$.PerformSyncUpdate(bP,bS,bR.docNode);},bR.updates);};q.Radio=function(bP,bQ,bR){var bS,bT;bS=V.CreateElement("input");bS.addEventListener("click",function(){return bR.Set(bQ);},false);bT=G.DynamicProp("checked",z.Map(function(bU){return J.Equals(bU,bQ);},bR.get_View()));return _3.New(bS,F.Concat(k.append(k.ofArray([F.Create("type","radio"),F.Create("name",bR.get_Id()),bT]),k.ofSeq(bP))),q.get_Empty());};q.InputInternal=function(bP,bQ){var bR;bR=V.CreateElement(bP);return _3.New(bR,F.Concat(bQ(bR)),q.get_Empty());};q.SelectImpl=function(bP,bQ,bR,bS){var bT,bU,bV,bW;function bX(b2){return b2.selectedIndex;}function bY(b2,b3){b2.selectedIndex=b3;}function bZ(b2){var b3;b3=bX(b2);return bT[0].get_Item(b3);}function b0(b2){return n.findIndex(function(b3){return J.Equals(b2,b3);},bT[0]);}function b1(b2,b3){return bY(b2,b0(b3));}bT=[B.Empty];bU=V.CreateElement("select");bV=G.DynamicCustom(function(b2){return function(b3){return b1(b2,b3);};},bS.get_View());bU.addEventListener("change",function(){bS.UpdateMaybe(function(b2){var b3;b3=bZ(bU);return J.Equals(b2,b3)?null:{$:1,$0:b3};});},false);return _3.New(bU,(bW=F.Append(bV,F.Concat(bP)),F.Append(G.OnAfterRender(function(b2){b1(b2,bS.Get());}),bW)),bR(bT));};q.New=bM.Ctor(function(bP,bQ){l.New.call(this);this.docNode=bP;this.updates=bQ;},q);s.NewFromSeq=function(bP){var bQ,bR,bS;bQ={};bR=H.Get(bP);try{while(bR.MoveNext()){bS=bR.Current();bQ[bS[0]]=bS[1];}}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}return bQ;};t.GetFieldValues=function(bP){var bQ,bR;bQ=[];for(var bS in bP)bQ.push(bP[bS]);return bQ;};u.Table=function(bP){function bQ(bX,bY){return q.Element("tr",B.Empty,k.ofArray([q.Element("td",B.Empty,L.toList(bX.Label)),q.Element("td",B.Empty,k.ofArray([bY]))]));}function bR(bX){return q.Element("table",B.Empty,k.ofArray([q.Element("tbody",B.Empty,bX)]));}function bS(bX,bY){var bZ;return q.Append((bZ=bX.Label,bZ!=null&&bZ.$==1?q.Element("td",B.Empty,k.ofArray([bZ.$0])):q.get_Empty()),q.Element("td",B.Empty,k.ofArray([bY])));}function bT(bX){return bR(k.ofArray([q.Element("tr",B.Empty,bX)]));}function bU(bX){return k.collect(function(bY){var bZ;bZ=bY.Shape;return bZ.$==3?k.ofArray([bS(bY,bR(bV(bZ.$0)))]):bZ.$==0?k.ofArray([bS(bY,bZ.$0)]):bZ.$==1?k.ofArray([q.BindView(function(b0){return q.Concat(bU(b0));},bZ.$0)]):bZ.$==4?k.ofArray([bZ.$1(bW(u.New(bZ.$0,null)))]):bU(bZ.$0);},k.rev(bX));}function bV(bX){return k.collect(function(bY){var bZ;bZ=bY.Shape;return bZ.$==3?bV(bZ.$0):bZ.$==0?k.ofArray([bQ(bY,bZ.$0)]):bZ.$==1?k.ofArray([q.BindView(function(b0){return q.Concat(bV(b0));},bZ.$0)]):bZ.$==4?k.ofArray([bZ.$1(bW(u.New(bZ.$0,null)))]):k.ofArray([bQ(bY,bT(bU(bZ.$0)))]);},k.rev(bX));}function bW(bX){var bY,bZ;bZ=bX.Shape;switch(bZ.$==3?1:bZ.$==0?2:bZ.$==1?2:bZ.$==4?3:0){case 0:return bT(bU(bZ.$0));case 1:return bR(bV(bZ.$0));case 2:return bR(bV(k.ofArray([bX])));case 3:return bZ.$1(bW(u.New(bZ.$0,null)));}}return bW(bP);};u.Item=function(bP){return u.New({$:0,$0:bP},null);};u.OfList=function(bP){var bQ;return(bP.$==1?bP.$1.$==0?(bQ=bP.$0,true):(bQ=bP,false):(bQ=bP,false))?bQ:u.Vertical(bQ);};u.Varying=function(bP){return u.New({$:1,$0:bP},null);};u.Wrap=function(bP,bQ){return u.New({$:4,$0:bQ.Shape,$1:bP},bQ.Label);};u.Vertical=function(bP){return u.New({$:3,$0:bP},null);};u.New=function(bP,bQ){return{Shape:bP,Label:bQ};};v.Fresh=function(){return{$:0,$0:P.Int()};};w=c.Var=bM.Class({},l,w);w.New=bM.Ctor(function(){l.New.call(this);},w);x.IsNotEmpty=function(bP,bQ){return x.Is(function(bR){return""!==bR;},bP,bQ);};x.Is=function(bP,bQ,bR){return h.MapToResult(function(bS){return bP(bS)?{$:0,$0:bS}:{$:1,$0:k.ofArray([bQ])};},bR);};y.Create=function(bP,bQ){return y.CreateWithStorage(bP,R.InMemory(C.ofSeq(bQ)));};y.CreateWithStorage=function(bP,bQ){return new y.New(bP,bQ);};h=d.Formlet=bM.Class({get_Data:function(){return this.$0;}},null,h);z.Map2=function(bP,bQ,bR){return z.CreateLazy(function(){return S.Map2(bP,bQ(),bR());});};z.Const=function(bP){var bQ;bQ=S.New({$:0,$0:bP});return function(){return bQ;};};z.Map=function(bP,bQ){return z.CreateLazy(function(){return S.Map(bP,bQ());});};z.CreateLazy=function(bP){var bQ;bQ={c:null,o:bP};return function(){var bR,bS;bR=bQ.c;return bR===null?(bR=bQ.o(),bQ.c=bR,(bS=bR.s,bS!=null&&bS.$==0)?bQ.o=null:S.WhenObsoleteRun(bR,function(){bQ.c=null;}),bR):bR;};};z.Map2Unit=function(bP,bQ){return z.CreateLazy(function(){return S.Map2Unit(bP(),bQ());});};z.Bind=function(bP,bQ){return z.Join(z.Map(bP,bQ));};z.SnapshotOn=function(bP,bQ,bR){var bS;bS=S.New({$:2,$0:bP,$1:[]});return z.CreateLazy(function(){return bS.s==null?S.SnapshotOn(bQ(),bR()):(S.WhenObsolete(bQ(),bS),bS);});};z.Join=function(bP){return z.CreateLazy(function(){return S.Join(bP());});};z.Sink=function(bP,bQ){function bR(){S.WhenRun(bQ(),bP,function(){bt.scheduler().Fork(bR);});}bt.scheduler().Fork(bR);};A.Apply=function(bP,bQ){return bP.$==1?bQ.$==1?{$:1,$0:k.append(bP.$0,bQ.$0)}:{$:1,$0:bP.$0}:bQ.$==1?{$:1,$0:bQ.$0}:{$:0,$0:bP.$0(bQ.$0)};};A.IsFailure=function(bP){return bP.$==1;};A.Append=function(bP,bQ){return bP.$==1?bQ.$==1?{$:1,$0:k.append(bP.$0,bQ.$0)}:bQ:bQ.$==1?bQ:{$:0,$0:n.append(bP.$0,bQ.$0)};};A.Map=function(bP,bQ){return bQ.$==1?{$:1,$0:bQ.$0}:{$:0,$0:bP(bQ.$0)};};A.Bind=function(bP,bQ){return bQ.$==1?{$:1,$0:bQ.$0}:bP(bQ.$0);};B=k.T=bM.Class({get_Item:function(bP){return n.nth(bP,this);},GetEnumerator:function(){return new I.New(this,null,function(bP){var bQ;bQ=bP.s;return bQ.$==0?false:(bP.c=bQ.$0,bP.s=bQ.$1,true);},void 0);},GetEnumerator0:function(){return H.Get(this);}},null,B);B.Empty=new B({$:0});C.get=function(bP,bQ){C.checkBounds(bP,bQ);return bP[bQ];};C.length=function(bP){return bP.dims===2?bP.length*bP.length:bP.length;};C.checkBounds=function(bP,bQ){if(bQ<0||bQ>=bP.length)i.FailWith("Index was outside the bounds of the array.");};C.set=function(bP,bQ,bR){C.checkBounds(bP,bQ);bP[bQ]=bR;};D.$cctor=function(){D.$cctor=a.ignore;D.Do=new m.New();};E=c.Submitter=bM.Class({Trigger:function(){this["var"].Set(null);}},l,E);E.New=bM.Ctor(function(bP,bQ){l.New.call(this);this.input=bP;this["var"]=Q.Create();this.view=z.SnapshotOn(bQ,this["var"].get_View(),this.input);},E);F=c.AttrProxy=bM.Class({},null,F);F.Create=function(bP,bQ){return W.Static(function(bR){V.SetAttr(bR,bP,bQ);});};F.Concat=function(bP){var bQ;bQ=K.ofSeqNonCopying(bP);return K.TreeReduce(W.EmptyAttr(),F.Append,bQ);};F.Append=function(bP,bQ){return W.AppendTree(bP,bQ);};G.Class=function(bP){return G.ClassPred(bP,true);};G.Handler=function(bP,bQ){return W.Static(function(bR){bR.addEventListener(bP,function(bS){return(bQ(bR))(bS);},false);});};G.DynamicPred=function(bP,bQ,bR){function bS(bT,bU){return bU[0]?V.SetAttr(bT,bP,bU[1]):V.RemoveAttr(bT,bP);}return W.Dynamic(z.Map2(function(bT,bU){return[bT,bU];},bQ,bR),function(bT){return function(bU){return bS(bT,bU);};});};G.ClassPred=function(bP,bQ){return W.Static(function(bR){if(bQ)V.AddClass(bR,bP);else V.RemoveClass(bR,bP);});};G.Value=function(bP){function bQ(bR){return{$:1,$0:bR};}return G.CustomValue(bP,a.id,function(bR){return bQ(a.id(bR));});};G.Checked=function(bP){function bQ(bR,bS){return!J.Equals(bP.Get(),bR.checked)?bP.Set(bR.checked):null;}return F.Concat([G.DynamicProp("checked",bP.get_View()),G.Handler("change",function(bR){return function(bS){return bQ(bR,bS);};})]);};G.DynamicProp=function(bP,bQ){return W.Dynamic(bQ,function(bR){return function(bS){bR[bP]=bS;};});};G.CustomValue=function(bP,bQ,bR){return G.CustomVar(bP,function(bS,bT){bS.value=bQ(bT);},function(bS){return bR(bS.value);});};G.OnAfterRender=function(bP){return new F({$:4,$0:bP});};G.DynamicCustom=function(bP,bQ){return W.Dynamic(bQ,bP);};G.CustomVar=function(bP,bQ,bR){function bS(bU,bV){return bP.UpdateMaybe(function(bW){var bX,bY;bX=bR(bU);return bX!=null&&bX.$==1&&(!J.Equals(bX.$0,bW)&&(bY=[bX,bX.$0],true))?bY[0]:null;});}function bT(bU,bV){var bW,bX;bW=bR(bU);return bW!=null&&bW.$==1&&(J.Equals(bW.$0,bV)&&(bX=bW.$0,true))?null:bQ(bU,bV);}return F.Concat([G.Handler("change",function(bU){return function(bV){return bS(bU,bV);};}),G.Handler("input",function(bU){return function(bV){return bS(bU,bV);};}),G.Handler("keypress",function(bU){return function(bV){return bS(bU,bV);};}),G.DynamicCustom(function(bU){return function(bV){return bT(bU,bV);};},bP.get_View())]);};z=c.View=bM.Class({},null,z);H.Get=function(bP){return bP instanceof a.Array?H.ArrayEnumerator(bP):J.Equals(typeof bP,"string")?H.StringEnumerator(bP):bP.GetEnumerator();};H.ArrayEnumerator=function(bP){return new I.New(0,null,function(bQ){var bR;bR=bQ.s;return bR<C.length(bP)&&(bQ.c=C.get(bP,bR),bQ.s=bR+1,true);},void 0);};H.StringEnumerator=function(bP){return new I.New(0,null,function(bQ){var bR;bR=bQ.s;return bR<bP.length&&(bQ.c=bP[bR],bQ.s=bR+1,true);},void 0);};H.Get0=function(bP){return bP instanceof a.Array?H.ArrayEnumerator(bP):J.Equals(typeof bP,"string")?H.StringEnumerator(bP):"GetEnumerator0"in bP?bP.GetEnumerator0():bP.GetEnumerator();};I=H.T=bM.Class({Dispose:function(){if(this.d)this.d(this);},MoveNext:function(){return this.n(this);},Current:function(){return this.c;}},l,I);I.New=bM.Ctor(function(bP,bQ,bR,bS){l.New.call(this);this.s=bP;this.c=bQ;this.n=bR;this.d=bS;},I);J.Equals=function(bP,bQ){var bR,bS,bT,bU;if(bP===bQ)return true;else{bR=typeof bP;if(bR=="object"){if(bP===null||bP===void 0||bQ===null||bQ===void 0)return false;else if("Equals"in bP)return bP.Equals(bQ);else if(bP instanceof a.Array&&bQ instanceof a.Array)return J.arrayEquals(bP,bQ);else if(bP instanceof a.Date&&bQ instanceof a.Date)return J.dateEquals(bP,bQ);else{bS=[true];for(var bV in bP)if(function(bW){bS[0]=!bP.hasOwnProperty(bW)||bQ.hasOwnProperty(bW)&&J.Equals(bP[bW],bQ[bW]);return!bS[0];}(bV))break;if(bS[0]){for(var bW in bQ)if(function(bX){bS[0]=!bQ.hasOwnProperty(bX)||bP.hasOwnProperty(bX);return!bS[0];}(bW))break;}return bS[0];}}else return bR=="function"&&("$Func"in bP?bP.$Func===bQ.$Func&&bP.$Target===bQ.$Target:"$Invokes"in bP&&"$Invokes"in bQ&&J.arrayEquals(bP.$Invokes,bQ.$Invokes));}};J.arrayEquals=function(bP,bQ){var bR,bS;if(C.length(bP)===C.length(bQ)){bR=true;bS=0;while(bR&&bS<C.length(bP)){!J.Equals(C.get(bP,bS),C.get(bQ,bS))?bR=false:void 0;bS=bS+1;}return bR;}else return false;};J.dateEquals=function(bP,bQ){return bP.getTime()===bQ.getTime();};J.Hash=function(bP){var bQ;bQ=typeof bP;return bQ=="function"?0:bQ=="boolean"?bP?1:0:bQ=="number"?bP:bQ=="string"?J.hashString(bP):bQ=="object"?bP==null?0:bP instanceof a.Array?J.hashArray(bP):J.hashObject(bP):0;};J.hashString=function(bP){var bQ,bR,bS;if(bP===null)return 0;else{bQ=5381;for(bR=0,bS=bP.length-1;bR<=bS;bR++)bQ=J.hashMix(bQ,bP[bR].charCodeAt());return bQ;}};J.hashArray=function(bP){var bQ,bR,bS;bQ=-34948909;for(bR=0,bS=C.length(bP)-1;bR<=bS;bR++)bQ=J.hashMix(bQ,J.Hash(C.get(bP,bR)));return bQ;};J.hashObject=function(bP){var bQ,bR;if("GetHashCode"in bP)return bP.GetHashCode();else{bQ=[0];for(var bS in bP)if(function(bT){bQ[0]=J.hashMix(J.hashMix(bQ[0],J.hashString(bT)),J.Hash(bP[bT]));return false;}(bS))break;return bQ[0];}};J.hashMix=function(bP,bQ){return(bP<<5)+bP+bQ;};J.Compare=function(bP,bQ){var bR,bS,bT,bU,bV,bW;if(bP===bQ)return 0;else{bS=typeof bP;switch(bS=="function"?1:bS=="boolean"?2:bS=="number"?2:bS=="string"?2:bS=="object"?3:0){case 0:return typeof bQ=="undefined"?0:-1;case 1:return i.FailWith("Cannot compare function values.");case 2:return bP<bQ?-1:1;case 3:if(bP===null)bT=-1;else if(bQ===null)bT=1;else if("CompareTo"in bP)bT=bP.CompareTo(bQ);else if("CompareTo0"in bP)bT=bP.CompareTo0(bQ);else if(bP instanceof a.Array&&bQ instanceof a.Array)bT=J.compareArrays(bP,bQ);else if(bP instanceof a.Date&&bQ instanceof a.Date)bT=J.compareDates(bP,bQ);else{bU=[0];for(var bX in bP)if(function(bY){return!bP.hasOwnProperty(bY)?false:!bQ.hasOwnProperty(bY)?(bU[0]=1,true):(bU[0]=J.Compare(bP[bY],bQ[bY]),bU[0]!==0);}(bX))break;if(bU[0]===0){for(var bY in bQ)if(function(bZ){return!bQ.hasOwnProperty(bZ)?false:!bP.hasOwnProperty(bZ)&&(bU[0]=-1,true);}(bY))break;}bT=bU[0];}return bT;}}};J.compareArrays=function(bP,bQ){var bR,bS;if(C.length(bP)<C.length(bQ))return -1;else if(C.length(bP)>C.length(bQ))return 1;else{bR=0;bS=0;while(bR===0&&bS<C.length(bP)){bR=J.Compare(C.get(bP,bS),C.get(bQ,bS));bS=bS+1;}return bR;}};J.compareDates=function(bP,bQ){return J.Compare(bP.getTime(),bQ.getTime());};K.ofSeqNonCopying=function(bP){var bQ,bR;if(bP instanceof a.Array)return bP;else if(bP instanceof B)return C.ofList(bP);else if(bP===null)return[];else{bQ=[];bR=H.Get(bP);try{while(bR.MoveNext())bQ.push(bR.Current());return bQ;}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}}};K.TreeReduce=function(bP,bQ,bR){var bS;function bT(bU,bV){var bW,bX;return bV<=0?bP:bV===1&&(bU>=0&&bU<bS)?C.get(bR,bU):(bX=bV/2>>0,bQ(bT(bU,bX),bT(bU+bX,bV-bX)));}bS=C.length(bR);return bT(0,bS);};K.MapTreeReduce=function(bP,bQ,bR,bS){var bT;function bU(bV,bW){var bX,bY;return bW<=0?bQ:bW===1&&(bV>=0&&bV<bT)?bP(C.get(bS,bV)):(bY=bW/2>>0,bR(bU(bV,bY),bU(bV+bY,bW-bY)));}bT=C.length(bS);return bU(0,bT);};L.toList=function(bP){return bP==null?B.Empty:k.ofArray([bP.$0]);};N.LoadLocalTemplates=function(bP){!N.LocalTemplatesLoaded()?(N.set_LocalTemplatesLoaded(true),N.LoadNestedTemplates(self.document.body,"")):void 0;N.LoadedTemplates().set_Item(bP,N.LoadedTemplateFile(""));};N.LocalTemplatesLoaded=function(){_7.$cctor();return _7.LocalTemplatesLoaded;};N.set_LocalTemplatesLoaded=function(bP){_7.$cctor();_7.LocalTemplatesLoaded=bP;};N.LoadNestedTemplates=function(bP,bQ){var bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5;function bR(b6){var b7,b8;if(!bS.ContainsKey(b6)){b7=(b8=null,[bT.TryGetValue(b6,{get:function(){return b8;},set:function(b9){b8=b9;}}),b8]);b7[0]?(b5.Add(b6),bT.Remove(b6),N.PrepareTemplateStrict(bQ,{$:1,$0:b6},b7[1][0],{$:1,$0:b7[1][1]},{$:1,$0:bR})):bK.warn(b5.Contains(b6)?"Encountered loop when instantiating "+b6:"Local template does not exist: "+b6);}}bS=N.LoadedTemplateFile(bQ);bT=new U.New$5();bU=bP.querySelectorAll("[ws-template]");for(bV=0,bW=bU.length-1;bV<=bW;bV++){bX=bU[bV];bY=bX.getAttribute("ws-template").toLowerCase();bX.removeAttribute("ws-template");bT.set_Item(bY,[[bX],N.FakeRootSingle(bX)]);}bZ=bP.querySelectorAll("[ws-children-template]");for(b0=0,b1=bZ.length-1;b0<=b1;b0++){b2=bZ[b0];b3=b2.getAttribute("ws-children-template").toLowerCase();b2.removeAttribute("ws-children-template");bT.set_Item(b3,(b4=V.ChildrenArray(b2),[b4,N.FakeRoot(b4)]));}b5=new _8.New$3();while(bT.count>0)bR(n.head(bT.get_Keys()));};N.LoadedTemplates=function(){_7.$cctor();return _7.LoadedTemplates;};N.LoadedTemplateFile=function(bP){var bQ,bR,bS;bQ=(bR=null,[N.LoadedTemplates().TryGetValue(bP,{get:function(){return bR;},set:function(bT){bR=bT;}}),bR]);return bQ[0]?bQ[1]:(bS=new U.New$5(),(N.LoadedTemplates().set_Item(bP,bS),bS));};N.FakeRootSingle=function(bP){var bQ,bR,bS;bP.removeAttribute("ws-template");bQ=bP.getAttribute("ws-replace");bQ===null?void 0:(bP.removeAttribute("ws-replace"),bR=bP.parentNode,J.Equals(bR,null)?void 0:(bS=self.document.createElement(bP.tagName),bS.setAttribute("ws-replace",bQ),bR.replaceChild(bS,bP)));return N.FakeRoot([bP]);};N.FakeRoot=function(bP){var bQ,bR,bS;bQ=self.document.createElement("div");for(bR=0,bS=bP.length-1;bR<=bS;bR++)bQ.appendChild(C.get(bP,bR));return bQ;};N.PrepareTemplateStrict=function(bP,bQ,bR,bS,bT){var bU,bV;function bW(b1,b2){var b3,b4,b5,b6,b7,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr;function b8(cs){}while(true)switch(b1){case 0:if(b2!==null){b3=b2.nextSibling;if(J.Equals(b2.nodeType,Z.TEXT_NODE))be.convertTextNode(b2);else if(J.Equals(b2.nodeType,Z.ELEMENT_NODE))bY(b2);b2=b3;}else return null;break;case 1:b9=bf.string(b2.nodeName,{$:1,$0:3},null).toLowerCase();b_=(b4=b9.indexOf("."),b4===-1?[bP,b9]:[bf.string(b9,null,{$:1,$0:b4-1}),bf.string(b9,{$:1,$0:b4+1},null)]);b$=b_[1];ca=b_[0];if(ca!==""&&!N.LoadedTemplates().ContainsKey(ca))return be.failNotLoaded(b$);else{if(ca===""&&bT!=null)bT.$0(b$);cb=N.LoadedTemplates().get_Item(ca);if(!cb.ContainsKey(b$))return be.failNotLoaded(b$);else{cc=cb.get_Item(b$);cd=cc.cloneNode(true);ce=new _8.New$3();cf=new U.New$5();cg=b2.attributes;for(ch=0,ci=cg.length-1;ch<=ci;ch++){cj=cg.item(ch).name.toLowerCase();cf.set_Item(cj,(ck=cg.item(ch).nodeValue,ck===""?cj:ck.toLowerCase()));!ce.Add(cj)?bK.warn("Hole mapped twice",cj):void 0;}for(cl=0,cm=b2.childNodes.length-1;cl<=cm;cl++){cn=b2.childNodes[cl];J.Equals(cn.nodeType,Z.ELEMENT_NODE)?!ce.Add(cn.nodeName.toLowerCase())?bK.warn("Hole filled twice",b$):void 0:void 0;}co=b2.childNodes.length===1&&J.Equals(b2.firstChild.nodeType,Z.TEXT_NODE);if(co){b6=be.fillTextHole(cd,b2.firstChild.textContent,b$);((function(cs){return function(ct){if(ct!=null)cs(ct.$0);};}((b7=function(cs){return function(ct){return cs.Add(ct);};}(ce),function(cs){return b8(b7(cs));})))(b6));}be.removeHolesExcept(cd,ce);if(!co){for(cp=0,cq=b2.childNodes.length-1;cp<=cq;cp++){cr=b2.childNodes[cp];J.Equals(cr.nodeType,Z.ELEMENT_NODE)?cr.hasAttributes()?be.fillInstanceAttrs(cd,cr):bX(cd,cr):void 0;}}be.mapHoles(cd,cf);be.fill(cd,b2.parentNode,b2);b2.parentNode.removeChild(b2);return;}}break;}}function bX(b1,b2){var b3,b5,b6;function b4(b7,b8){var b9,b_,b$;if(b5==="title"&&b2.hasChildNodes()){b9=bN.parseHTML(b2.textContent);b2.removeChild(b2.firstChild);for(b_=0,b$=b9.length-1;b_<=b$;b_++)b2.appendChild(C.get(b9,b_));}else null;bY(b2);return be.fill(b2,b7,b8);}b5=b2.nodeName.toLowerCase();V.IterSelector(b1,"[ws-attr-holes]",function(b7){var b8,b9,b_,b$,ca;b8=bl.SplitChars(b7.getAttribute("ws-attr-holes"),[" "],1);for(b9=0,b_=b8.length-1;b9<=b_;b9++){b$=C.get(b8,b9);b7.setAttribute(b$,(ca=new a.RegExp("\\${"+b5+"}","ig"),b7.getAttribute(b$).replace(ca,b2.textContent)));}});b6=b1.querySelector("[ws-hole="+b5+"]");if(J.Equals(b6,null)){b3=b1.querySelector("[ws-replace="+b5+"]");return J.Equals(b3,null)?null:(b4(b3.parentNode,b3),void b3.parentNode.removeChild(b3));}else{while(b6.hasChildNodes())b6.removeChild(b6.lastChild);b6.removeAttribute("ws-hole");return b4(b6,null);}}function bY(b1){if(bl.StartsWith(b1.nodeName.toLowerCase(),"ws-"))b0(b1);else{be.convertAttrs(b1);bZ(b1.firstChild);}}function bZ(b1){return bW(0,b1);}function b0(b1){return bW(1,b1);}bU=bS==null?N.FakeRoot(bR):bS.$0;bV=(bQ==null?"":bQ.$0).toLowerCase();N.LoadedTemplateFile(bP).set_Item(bV,bU);C.length(bR)>0?(function(b1){var b2,b3,b4,b5;while(true){b2=b1.querySelector("[ws-template]");if(J.Equals(b2,null)){b3=b1.querySelector("[ws-children-template]");if(J.Equals(b3,null))return null;else{b4=b3.getAttribute("ws-children-template");b3.removeAttribute("ws-children-template");N.PrepareTemplateStrict(bP,{$:1,$0:b4},V.ChildrenArray(b3),null,null);b1=b1;}}else{b5=b2.getAttribute("ws-template");(N.PrepareSingleTemplate(bP,{$:1,$0:b5},b2))(null);b1=b1;}}}(bU),bZ(C.get(bR,0))):void 0;};N.PrepareSingleTemplate=function(bP,bQ,bR){var bS,bT,bU;bS=N.FakeRootSingle(bR);bT=[bR];bU={$:1,$0:bS};return function(bV){N.PrepareTemplateStrict(bP,bQ,bT,bU,bV);};};N.TextHoleRE=function(){_7.$cctor();return _7.TextHoleRE;};y=c.ListModel=bM.Class({Iter:function(bP){C.iter(bP,this["var"].Get());},Lens:function(bP){return this.LensInto(a.id,function(bQ,bR){return bR;},bP);},ContainsKey:function(bP){var bQ;bQ=this;return C.exists(function(bR){return J.Equals(bQ.key(bR),bP);},this["var"].Get());},RemoveByKey:function(bP){var bQ;bQ=this;this["var"].Set(this.storage.SRemoveIf(function(bR){return J.Equals(bQ.key(bR),bP);},this["var"].Get()));this.ObsoleteKey(bP);},Append:function(bP){var bQ,bR,bS,bT;bQ=this;bR=this["var"].Get();bS=this.key(bP);bT=C.tryFindIndex(function(bU){return J.Equals(bQ.key(bU),bS);},bR);bT!=null&&bT.$==1?this["var"].Set(this.storage.SSetAt(bT.$0,bP,bR)):this["var"].Set(this.storage.SAppend(bP,bR));this.ObsoleteKey(bS);},LensInto:function(bP,bQ,bR){return this["LensInto'"](bP,bQ,bR,z.Map(bP,this.FindByKeyAsView(bR)));},ObsoleteKey:function(bP){var bQ,bR;bQ=(bR=null,[this.it.TryGetValue(bP,{get:function(){return bR;},set:function(bS){bR=bS;}}),bR]);bQ[0]?(S.Obsolete(bQ[1]),this.it.Remove(bP)):void 0;},"LensInto'":function(bP,bQ,bR,bS){var bT,bU,bV;bT=this;bU=P.Id();bV=new w({Get:function(){return bP(bT.FindByKey(bR));},Set:function(bW){return bT.UpdateBy(function(bX){return{$:1,$0:bQ(bX,bW)};},bR);},SetFinal:function(bW){return this.Set(bW);},Update:function(bW){return bT.UpdateBy(function(bX){return{$:1,$0:bQ(bX,bW(bP(bX)))};},bR);},UpdateMaybe:function(bW){return bT.UpdateBy(function(bX){var bY;bY=bW(bP(bX));return bY==null?null:{$:1,$0:bQ(bX,bY.$0)};},bR);},get_View:function(){return bS;},get_Id:function(){return bU;}});w.New.call(bV);return bV;},FindByKeyAsView:function(bP){return z.Map(function(bQ){return bQ.$0;},this.TryFindByKeyAsView(bP));},FindByKey:function(bP){var bQ;bQ=this;return C.find(function(bR){return J.Equals(bQ.key(bR),bP);},this["var"].Get());},UpdateBy:function(bP,bQ){var bR,bS,bT,bU,bV;bR=this;bS=this["var"].Get();bT=C.tryFindIndex(function(bW){return J.Equals(bR.key(bW),bQ);},bS);bT!=null&&bT.$==1?(bU=bT.$0,bV=bP(C.get(bS,bU)),bV!=null&&bV.$==1?(this["var"].Set(this.storage.SSetAt(bU,bV.$0,bS)),this.ObsoleteKey(bQ)):void 0):void 0;},TryFindByKeyAsView:function(bP){var bQ;bQ=this;return function(){var bR,bS,bT;bR=(bS=null,[bQ.it.TryGetValue(bP,{get:function(){return bS;},set:function(bU){bS=bU;}}),bS]);return bR[0]?bR[1]:(bT=S.New({$:2,$0:bQ.TryFindByKey(bP),$1:[]}),(bQ.it.Add(bP,bT),bT));};},TryFindByKey:function(bP){var bQ;bQ=this;return C.tryFind(function(bR){return J.Equals(bQ.key(bR),bP);},this["var"].Get());},GetEnumerator:function(){return H.Get(this["var"].Get());},GetEnumerator0:function(){return H.Get0(this["var"].Get());}},l,y);y.New=bM.Ctor(function(bP,bQ){y.New$3.call(this,bP,Q.Create$1(C.ofSeq(n.distinctBy(bP,bQ.SInit()))),bQ);},y);y.New$3=bM.Ctor(function(bP,bQ,bR){l.New.call(this);this.key=bP;this["var"]=bQ;this.storage=bR;this.v=z.Map(function(bS){return bS.slice();},this["var"].get_View());this.it=new U.New$5();},y);C.ofSeq=function(bP){var bQ,bR;if(bP instanceof a.Array)return bP.slice();else if(bP instanceof B)return C.ofList(bP);else{bQ=[];bR=H.Get(bP);try{while(bR.MoveNext())bQ.push(bR.Current());return bQ;}finally{if(typeof bR=="object"&&"Dispose"in bR)bR.Dispose();}}};C.ofList=function(bP){var bQ,bR;bR=[];bQ=bP;while(!(bQ.$==0)){bR.push(k.head(bQ));bQ=k.tail(bQ);}return bR;};C.iter=function(bP,bQ){var bR,bS;for(bR=0,bS=bQ.length-1;bR<=bS;bR++)bP(bQ[bR]);};C.exists=function(bP,bQ){var bR,bS,bT,bU;bR=false;bS=0;bU=C.length(bQ);while(!bR&&bS<bU)if(bP(bQ[bS]))bR=true;else bS=bS+1;return bR;};C.tryFindIndex=function(bP,bQ){var bR,bS;bR=null;bS=0;while(bS<bQ.length&&bR==null){bP(bQ[bS])?bR={$:1,$0:bS}:void 0;bS=bS+1;}return bR;};C.pick=function(bP,bQ){var bR;bR=C.tryPick(bP,bQ);return bR==null?i.FailWith("KeyNotFoundException"):bR.$0;};C.tryPick=function(bP,bQ){var bR,bS,bT;bR=null;bS=0;while(bS<bQ.length&&bR==null){bT=bP(bQ[bS]);bT!=null&&bT.$==1?bR=bT:void 0;bS=bS+1;}return bR;};C.filter=function(bP,bQ){var bR,bS,bT;bR=[];for(bS=0,bT=bQ.length-1;bS<=bT;bS++)if(bP(bQ[bS]))bR.push(bQ[bS]);return bR;};C.map=function(bP,bQ){var bR,bS,bT;bR=new a.Array(bQ.length);for(bS=0,bT=bQ.length-1;bS<=bT;bS++)bR[bS]=bP(bQ[bS]);return bR;};C.foldBack=function(bP,bQ,bR){var bS,bT,bU,bV,bW;bS=bR;bU=bQ.length;for(bV=1,bW=bU;bV<=bW;bV++)bS=bP(bQ[bU-bV],bS);return bS;};C.find=function(bP,bQ){var bR;bR=C.tryFind(bP,bQ);return bR==null?i.FailWith("KeyNotFoundException"):bR.$0;};C.concat=function(bP){return a.Array.prototype.concat.apply([],C.ofSeq(bP));};C.tryFind=function(bP,bQ){var bR,bS;bR=null;bS=0;while(bS<bQ.length&&bR==null){bP(bQ[bS])?bR={$:1,$0:bQ[bS]}:void 0;bS=bS+1;}return bR;};C.choose=function(bP,bQ){var bR,bS,bT,bU;bR=[];for(bS=0,bT=bQ.length-1;bS<=bT;bS++){bU=bP(bQ[bS]);bU==null?void 0:bR.push(bU.$0);}return bR;};C.create=function(bP,bQ){var bR,bS,bT;bR=new a.Array(bP);for(bS=0,bT=bP-1;bS<=bT;bS++)bR[bS]=bQ;return bR;};C.init=function(bP,bQ){var bR,bS,bT;bP<0?i.FailWith("Negative size given."):null;bR=new a.Array(bP);for(bS=0,bT=bP-1;bS<=bT;bS++)bR[bS]=bQ(bS);return bR;};C.forall=function(bP,bQ){var bR,bS,bT,bU;bR=true;bS=0;bU=C.length(bQ);while(bR&&bS<bU)if(bP(bQ[bS]))bS=bS+1;else bR=false;return bR;};P.Int=function(){P.set_counter(P.counter()+1);return P.counter();};P.set_counter=function(bP){ba.$cctor();ba.counter=bP;};P.counter=function(){ba.$cctor();return ba.counter;};P.Id=function(){P.set_counter(P.counter()+1);return"uid"+a.String(P.counter());};Q=c.Var$1=bM.Class({},l,Q);Q.Lens=function(bP,bQ,bR){var bS,bT,bU;bS=P.Id();bT=z.Map(bQ,bP.get_View());bU=new w({Get:function(){return bQ(bP.Get());},Set:function(bV){return bP.Update(function(bW){return bR(bW,bV);});},SetFinal:function(bV){return this.Set(bV);},Update:function(bV){return bP.Update(function(bW){return bR(bW,bV(bQ(bW)));});},UpdateMaybe:function(bV){return bP.UpdateMaybe(function(bW){var bX;bX=bV(bQ(bW));return bX==null?null:{$:1,$0:bR(bW,bX.$0)};});},get_View:function(){return bT;},get_Id:function(){return bS;}});w.New.call(bU);return bU;};Q.Create$1=function(bP){return new _1.New(false,S.New({$:2,$0:bP,$1:[]}),bP);};Q.Create=function(){return new _1.New(false,S.New({$:2,$0:null,$1:[]}),null);};R.InMemory=function(bP){return new _0.New(bP);};S.Map2=function(bP,bQ,bR){var bS,bT,bU;function bV(bW){var bX,bY,bZ;if(!(bX=bU.s,bX!=null&&bX.$==0||bX!=null&&bX.$==2)){bY=S.ValueAndForever(bQ);bZ=S.ValueAndForever(bR);bY!=null&&bY.$==1?bZ!=null&&bZ.$==1?bY.$0[1]&&bZ.$0[1]?S.MarkForever(bU,bP(bY.$0[0],bZ.$0[0])):S.MarkReady(bU,bP(bY.$0[0],bZ.$0[0])):void 0:void 0;}}bS=bQ.s;bT=bR.s;return bS!=null&&bS.$==0?bT!=null&&bT.$==0?S.New({$:0,$0:bP(bS.$0,bT.$0)}):S.Map2Opt1(bP,bS.$0,bR):bT!=null&&bT.$==0?S.Map2Opt2(bP,bT.$0,bQ):(bU=S.New({$:3,$0:[],$1:[]}),(S.When(bQ,bV,bU),S.When(bR,bV,bU),bU));};S.Map=function(bP,bQ){var bR,bS;bR=bQ.s;return bR!=null&&bR.$==0?S.New({$:0,$0:bP(bR.$0)}):(bS=S.New({$:3,$0:[],$1:[]}),(S.When(bQ,function(bT){S.MarkDone(bS,bQ,bP(bT));},bS),bS));};S.WhenObsoleteRun=function(bP,bQ){var bR;bR=bP.s;bR==null?bQ():bR!=null&&bR.$==2?bR.$1.push(bQ):bR!=null&&bR.$==3?bR.$1.push(bQ):void 0;};S.Map2Opt1=function(bP,bQ,bR){return S.Map(function(bS){return bP(bQ,bS);},bR);};S.Map2Opt2=function(bP,bQ,bR){return S.Map(function(bS){return bP(bS,bQ);},bR);};S.ValueAndForever=function(bP){var bQ;bQ=bP.s;return bQ!=null&&bQ.$==0?{$:1,$0:[bQ.$0,true]}:bQ!=null&&bQ.$==2?{$:1,$0:[bQ.$0,false]}:null;};S.MarkForever=function(bP,bQ){var bR,bS,bT,bU;bR=bP.s;if(bR!=null&&bR.$==3){bP.s={$:0,$0:bQ};bS=bR.$0;for(bT=0,bU=C.length(bS)-1;bT<=bU;bT++)(C.get(bS,bT))(bQ);}else void 0;};S.MarkReady=function(bP,bQ){var bR,bS,bT,bU;bR=bP.s;if(bR!=null&&bR.$==3){bP.s={$:2,$0:bQ,$1:bR.$1};bS=bR.$0;for(bT=0,bU=C.length(bS)-1;bT<=bU;bT++)(C.get(bS,bT))(bQ);}else void 0;};S.When=function(bP,bQ,bR){var bS;bS=bP.s;bS==null?S.Obsolete(bR):bS!=null&&bS.$==2?(S.EnqueueSafe(bS.$1,bR),bQ(bS.$0)):bS!=null&&bS.$==3?(bS.$0.push(bQ),S.EnqueueSafe(bS.$1,bR)):bQ(bS.$0);};S.MarkDone=function(bP,bQ,bR){var bS;if(bS=bQ.s,bS!=null&&bS.$==0)S.MarkForever(bP,bR);else S.MarkReady(bP,bR);};S.Map2Unit=function(bP,bQ){var bR,bS,bT;function bU(){var bV,bW,bX;if(!(bV=bT.s,bV!=null&&bV.$==0||bV!=null&&bV.$==2)){bW=S.ValueAndForever(bP);bX=S.ValueAndForever(bQ);bW!=null&&bW.$==1?bX!=null&&bX.$==1?bW.$0[1]&&bX.$0[1]?S.MarkForever(bT,null):S.MarkReady(bT,null):void 0:void 0;}}bR=bP.s;bS=bQ.s;return bR!=null&&bR.$==0?bS!=null&&bS.$==0?S.New({$:0,$0:null}):bQ:bS!=null&&bS.$==0?bP:(bT=S.New({$:3,$0:[],$1:[]}),(S.When(bP,bU,bT),S.When(bQ,bU,bT),bT));};S.EnqueueSafe=function(bP,bQ){var bR,bS,bT,bU;bP.push(bQ);if(bP.length%20===0){bR=bP.slice(0);br.Clear(bP);for(bS=0,bT=C.length(bR)-1;bS<=bT;bS++){bU=C.get(bR,bS);typeof bU=="object"?function(bV){if(bV.s)bP.push(bV);}(bU):function(bV){bP.push(bV);}(bU);}}else void 0;};S.SnapshotOn=function(bP,bQ){var bR;function bS(bT){var bU,bV,bW;if(!(bU=bR.s,bU!=null&&bU.$==0||bU!=null&&bU.$==2)){bV=S.ValueAndForever(bP);bW=S.ValueAndForever(bQ);bV!=null&&bV.$==1?bW!=null&&bW.$==1?bV.$0[1]||bW.$0[1]?S.MarkForever(bR,bW.$0[0]):S.MarkReady(bR,bW.$0[0]):void 0:void 0;}}bR=S.New({$:3,$0:[],$1:[]});S.When(bP,bS,bR);S.WhenReady(bQ,bS);return bR;};S.WhenObsolete=function(bP,bQ){var bR;bR=bP.s;bR==null?S.Obsolete(bQ):bR!=null&&bR.$==2?S.EnqueueSafe(bR.$1,bQ):bR!=null&&bR.$==3?S.EnqueueSafe(bR.$1,bQ):void 0;};S.Join=function(bP){var bQ;bQ=S.New({$:3,$0:[],$1:[]});S.When(bP,function(bR){var bS;bS=bR();S.When(bS,function(bT){var bU,bV;if((bU=bS.s,bU!=null&&bU.$==0)&&(bV=bP.s,bV!=null&&bV.$==0))S.MarkForever(bQ,bT);else S.MarkReady(bQ,bT);},bQ);},bQ);return bQ;};S.WhenReady=function(bP,bQ){var bR,bS;bS=bP.s;switch(bS!=null&&bS.$==2?(bR=bS.$0,0):bS==null?1:bS!=null&&bS.$==3?2:(bR=bS.$0,0)){case 0:bQ(bR);break;case 1:null;break;case 2:bS.$0.push(bQ);break;}};S.Copy=function(bP){var bQ,bR,bS;bQ=bP.s;return bQ==null?bP:bQ!=null&&bQ.$==2?(bR=S.New({$:2,$0:bQ.$0,$1:[]}),(S.WhenObsolete(bP,bR),bR)):bQ!=null&&bQ.$==3?(bS=S.New({$:3,$0:[],$1:[]}),(S.When(bP,function(bT){S.MarkDone(bS,bP,bT);},bS),bS)):bP;};S.WhenRun=function(bP,bQ,bR){var bS;bS=bP.s;bS==null?bR():bS!=null&&bS.$==2?(bS.$1.push(bR),bQ(bS.$0)):bS!=null&&bS.$==3?(bS.$0.push(bQ),bS.$1.push(bR)):bQ(bS.$0);};U=T.Dictionary=bM.Class({get_Item:function(bP){return this.get(bP);},set_Item:function(bP,bQ){this.set(bP,bQ);},get:function(bP){var bQ,bR;bQ=this;bR=this.data[this.hash(bP)];return bR==null?_2.notPresent():C.pick(function(bS){var bT;bT=i.KeyValue(bS);return bQ.equals.apply(null,[bT[0],bP])?{$:1,$0:bT[1]}:null;},bR);},set:function(bP,bQ){var bR,bS,bT,bU;bR=this;bS=this.hash(bP);bT=this.data[bS];bT==null?(this.count=this.count+1,this.data[bS]=new a.Array({K:bP,V:bQ})):(bU=C.tryFindIndex(function(bV){return bR.equals.apply(null,[(i.KeyValue(bV))[0],bP]);},bT),bU==null?(this.count=this.count+1,bT.push({K:bP,V:bQ})):bT[bU.$0]={K:bP,V:bQ});},ContainsKey:function(bP){var bQ,bR;bQ=this;bR=this.data[this.hash(bP)];return bR==null?false:C.exists(function(bS){return bQ.equals.apply(null,[(i.KeyValue(bS))[0],bP]);},bR);},TryGetValue:function(bP,bQ){var bR,bS,bT;bR=this;bS=this.data[this.hash(bP)];return bS==null?false:(bT=C.tryPick(function(bU){var bV;bV=i.KeyValue(bU);return bR.equals.apply(null,[bV[0],bP])?{$:1,$0:bV[1]}:null;},bS),bT!=null&&bT.$==1&&(bQ.set(bT.$0),true));},Remove:function(bP){return this.remove(bP);},get_Keys:function(){return new bg.New(this);},remove:function(bP){var bQ,bR,bS,bT;bQ=this;bR=this.hash(bP);bS=this.data[bR];return bS==null?false:(bT=C.filter(function(bU){return!bQ.equals.apply(null,[(i.KeyValue(bU))[0],bP]);},bS),C.length(bT)<bS.length&&(this.count=this.count-1,this.data[bR]=bT,true));},Add:function(bP,bQ){this.add(bP,bQ);},add:function(bP,bQ){var bR,bS,bT;bR=this;bS=this.hash(bP);bT=this.data[bS];bT==null?(this.count=this.count+1,this.data[bS]=new a.Array({K:bP,V:bQ})):(C.exists(function(bU){return bR.equals.apply(null,[(i.KeyValue(bU))[0],bP]);},bT)?_2.alreadyAdded():void 0,this.count=this.count+1,bT.push({K:bP,V:bQ}));},GetEnumerator:function(){return H.Get0(this);},GetEnumerator0:function(){return H.Get0(C.concat(t.GetFieldValues(this.data)));}},l,U);U.New$5=bM.Ctor(function(){U.New$6.call(this,[],J.Equals,J.Hash);},U);U.New$6=bM.Ctor(function(bP,bQ,bR){var bS,bT;l.New.call(this);this.equals=bQ;this.hash=bR;this.count=0;this.data=[];bS=H.Get(bP);try{while(bS.MoveNext()){bT=bS.Current();this.set(bT.K,bT.V);}}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}},U);V.CreateElement=function(bP){return V.Doc().createElement(bP);};V.SetAttr=function(bP,bQ,bR){bP.setAttribute(bQ,bR);};V.RemoveAttr=function(bP,bQ){bP.removeAttribute(bQ);};V.CreateText=function(bP){return V.Doc().createTextNode(bP);};V.Doc=function(){_.$cctor();return _.Doc;};V.AddClass=function(bP,bQ){var bR;bR=V.getClass(bP);bR===""?V.setClass(bP,bQ):!V.clsRE(bQ).test(bR)?V.setClass(bP,bR+" "+bQ):void 0;};V.RemoveClass=function(bP,bQ){var bR;V.setClass(bP,(bR=V.clsRE(bQ),V.getClass(bP).replace(bR,function(bS,bT,bU){return bT===""||bU===""?"":" ";})));};V.ChildrenArray=function(bP){var bQ,bR,bS;bQ=[];for(bR=0,bS=bP.childNodes.length-1;bR<=bS;bR++)bQ.push(bP.childNodes[bR]);return bQ;};V.getClass=function(bP){return bP instanceof a.SVGElement?bP.getAttribute("class"):bP.className;};V.setClass=function(bP,bQ){if(bP instanceof a.SVGElement)bP.setAttribute("class",bQ);else bP.className=bQ;};V.clsRE=function(bP){return new a.RegExp("(\\s+|^)"+bP+"(?:\\s+"+bP+")*(\\s+|$)","g");};V.IterSelector=function(bP,bQ,bR){var bS,bT,bU;bS=bP.querySelectorAll(bQ);for(bT=0,bU=bS.length-1;bT<=bU;bT++)bR(bS[bT]);};V.InsertAt=function(bP,bQ,bR){var bS;if(!(bR.parentNode===bP&&bQ===(bS=bR.nextSibling,J.Equals(bS,null)?null:bS)))bP.insertBefore(bR,bQ);};V.RemoveNode=function(bP,bQ){if(bQ.parentNode===bP)bP.removeChild(bQ);};W.Static=function(bP){return new F({$:3,$0:bP});};W.Dynamic=function(bP,bQ){return new F({$:1,$0:new _4.New(bP,bQ)});};W.Updates=function(bP){return K.MapTreeReduce(function(bQ){return bQ.NChanged();},z.Const(),z.Map2Unit,bP.DynNodes);};W.AppendTree=function(bP,bQ){var bR;return bP===null?bQ:bQ===null?bP:(bR=new F({$:2,$0:bP,$1:bQ}),(W.SetFlags(bR,W.Flags(bP)|W.Flags(bQ)),bR));};W.EmptyAttr=function(){bk.$cctor();return bk.EmptyAttr;};W.Insert=function(bP,bQ){var bR,bS,bT;function bU(bV){if(!(bV===null))if(bV!=null&&bV.$==1)bR.push(bV.$0);else if(bV!=null&&bV.$==2){bU(bV.$0);bU(bV.$1);}else if(bV!=null&&bV.$==3)bV.$0(bP);else if(bV!=null&&bV.$==4)bS.push(bV.$0);}bR=[];bS=[];bU(bQ);bT=bR.slice(0);return bd.New(bP,W.Flags(bQ),bT,bS.length===0?null:{$:1,$0:function(bV){n.iter(function(bW){bW(bV);},bS);}});};W.SetFlags=function(bP,bQ){bP.flags=bQ;};W.Flags=function(bP){return bP!==null&&bP.hasOwnProperty("flags")?bP.flags:0;};W.HasExitAnim=function(bP){var bQ;bQ=2;return(bP.DynFlags&bQ)===bQ;};W.GetExitAnim=function(bP){return W.GetAnim(bP,function(bQ,bR){return bQ.NGetExitAnim(bR);});};W.HasEnterAnim=function(bP){var bQ;bQ=1;return(bP.DynFlags&bQ)===bQ;};W.GetEnterAnim=function(bP){return W.GetAnim(bP,function(bQ,bR){return bQ.NGetEnterAnim(bR);});};W.HasChangeAnim=function(bP){var bQ;bQ=4;return(bP.DynFlags&bQ)===bQ;};W.GetChangeAnim=function(bP){return W.GetAnim(bP,function(bQ,bR){return bQ.NGetChangeAnim(bR);});};W.GetAnim=function(bP,bQ){return bh.Concat(C.map(function(bR){return bQ(bR,bP.DynElem);},bP.DynNodes));};W.Sync=function(bP,bQ){C.iter(function(bR){bR.NSync(bP);},bQ.DynNodes);};_0=R.ArrayStorage=bM.Class({SRemoveIf:function(bP,bQ){return C.filter(function(bR){return!bP(bR);},bQ);},SSetAt:function(bP,bQ,bR){C.set(bR,bP,bQ);return bR;},SAppend:function(bP,bQ){bQ.push(bP);return bQ;},SInit:function(){return this.init;}},l,_0);_0.New=bM.Ctor(function(bP){l.New.call(this);this.init=bP;},_0);S.Obsolete=function(bP){var bQ,bR,bS,bT,bU;bR=bP.s;if(bR==null||(bR!=null&&bR.$==2?(bQ=bR.$1,false):bR!=null&&bR.$==3?(bQ=bR.$1,false):true))void 0;else{bP.s=null;for(bS=0,bT=C.length(bQ)-1;bS<=bT;bS++){bU=C.get(bQ,bS);typeof bU=="object"?function(bV){S.Obsolete(bV);}(bU):bU();}}};S.New=function(bP){return{s:bP};};_1=c.ConcreteVar=bM.Class({Get:function(){return this.current;},Update:function(bP){this.Set(bP(this.Get()));},Set:function(bP){if(this.isConst)(function(bQ){return bQ("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bQ){bK.log(bQ);}));else{S.Obsolete(this.snap);this.current=bP;this.snap=S.New({$:2,$0:bP,$1:[]});}},UpdateMaybe:function(bP){var bQ;bQ=bP(this.Get());bQ!=null&&bQ.$==1?this.Set(bQ.$0):void 0;},get_View:function(){return this.view;},get_Id:function(){return"uinref"+a.String(this.id);}},w,_1);_1.New=bM.Ctor(function(bP,bQ,bR){var bS;bS=this;w.New.call(this);this.isConst=bP;this.current=bR;this.snap=bQ;this.view=function(){return bS.snap;};this.id=P.Int();},_1);_2.notPresent=function(){return i.FailWith("The given key was not present in the dictionary.");};_2.alreadyAdded=function(){return i.FailWith("An item with the same key has already been added.");};_3=c.Elt=bM.Class({},q,_3);_3.New=function(bP,bQ,bR){var bS,bT;bS=$.CreateElemNode(bP,bQ,bR.docNode);bT=bb.Create(bR.updates);return new _3.New$1({$:1,$0:bS},z.Map2Unit(W.Updates(bS.Attr),bT.v),bP,bT);};_3.New$1=bM.Ctor(function(bP,bQ,bR,bS){q.New.call(this,bP,bQ);this.docNode$1=bP;this.updates$1=bQ;this.elt=bR;this.rvUpdates=bS;},_3);_4=c.DynamicAttrNode=bM.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(bP){return bh.get_Empty();},NGetEnterAnim:function(bP){return bh.get_Empty();},NGetChangeAnim:function(bP){return bh.get_Empty();},NSync:function(bP){if(this.dirty){(this.push(bP))(this.value);this.dirty=false;}}},l,_4);_4.New=bM.Ctor(function(bP,bQ){var bR;bR=this;l.New.call(this);this.push=bQ;this.value=void 0;this.dirty=false;this.updates=z.Map(function(bS){bR.value=bS;bR.dirty=true;},bP);},_4);_5=c.DocElemNode=bM.Class({Equals:function(bP){return this.ElKey===bP.ElKey;},GetHashCode:function(){return this.ElKey;}},null,_5);_5.New=function(bP,bQ,bR,bS,bT,bU){var bV;return new _5((bV={Attr:bP,Children:bQ,El:bS,ElKey:bT},(bM.SetOptional(bV,"Delimiters",bR),bM.SetOptional(bV,"Render",bU),bV)));};_7.$cctor=function(){_7.$cctor=a.ignore;_7.LoadedTemplates=new U.New$5();_7.LocalTemplatesLoaded=false;_7.TextHoleRE="\\${([^}]+)}";};_8=T.HashSet=bM.Class({Add:function(bP){return this.add(bP);},Contains:function(bP){var bQ;bQ=this.data[this.hash(bP)];return bQ==null?false:this.arrContains(bP,bQ);},add:function(bP){var bQ,bR;bQ=this.hash(bP);bR=this.data[bQ];return bR==null?(this.data[bQ]=[bP],this.count=this.count+1,true):this.arrContains(bP,bR)?false:(bR.push(bP),this.count=this.count+1,true);},arrContains:function(bP,bQ){var bR,bS,bT,bU;bR=true;bS=0;bU=bQ.length;while(bR&&bS<bU)if(this.equals.apply(null,[bQ[bS],bP]))bR=false;else bS=bS+1;return!bR;},ExceptWith:function(bP){var bQ;bQ=H.Get(bP);try{while(bQ.MoveNext())this.Remove(bQ.Current());}finally{if(typeof bQ=="object"&&"Dispose"in bQ)bQ.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(bP){var bQ,bR,bS,bT;bQ=0;bR=bv.concat(this.data);for(bS=0,bT=bR.length-1;bS<=bT;bS++)C.set(bP,bS,bR[bS]);},IntersectWith:function(bP){var bQ,bR,bS,bT,bU;bQ=new _8.New$4(bP,this.equals,this.hash);bR=bv.concat(this.data);for(bS=0,bT=bR.length-1;bS<=bT;bS++){bU=bR[bS];!bQ.Contains(bU)?this.Remove(bU):void 0;}},Remove:function(bP){var bQ;bQ=this.data[this.hash(bP)];return bQ==null?false:this.arrRemove(bP,bQ)&&(this.count=this.count-1,true);},arrRemove:function(bP,bQ){var bR,bS,bT,bU;bR=true;bS=0;bU=bQ.length;while(bR&&bS<bU)if(this.equals.apply(null,[bQ[bS],bP])){bQ.splice.apply(bQ,[bS,1]);bR=false;}else bS=bS+1;return!bR;},GetEnumerator:function(){return H.Get(bv.concat(this.data));},GetEnumerator0:function(){return H.Get(bv.concat(this.data));}},l,_8);_8.New$3=bM.Ctor(function(){_8.New$4.call(this,[],J.Equals,J.Hash);},_8);_8.New$4=bM.Ctor(function(bP,bQ,bR){var bS;l.New.call(this);this.equals=bQ;this.hash=bR;this.data=[];this.count=0;bS=H.Get(bP);try{while(bS.MoveNext())this.add(bS.Current());}finally{if(typeof bS=="object"&&"Dispose"in bS)bS.Dispose();}},_8);_8.New$2=bM.Ctor(function(bP){_8.New$4.call(this,bP,J.Equals,J.Hash);},_8);_.$cctor=function(){_.$cctor=a.ignore;_.Doc=self.document;};$.LinkElement=function(bP,bQ){$.InsertDoc(bP,bQ,null);};$.CreateEmbedNode=function(){return{Current:null,Dirty:false};};$.UpdateEmbedNode=function(bP,bQ){bP.Current=bQ;bP.Dirty=true;};$.CreateElemNode=function(bP,bQ,bR){var bS;$.LinkElement(bP,bR);bS=W.Insert(bP,bQ);return _5.New(bS,bR,null,bP,P.Int(),bM.GetOptional(bS.OnAfterRender));};$.InsertDoc=function(bP,bQ,bR){var bS;return bQ!=null&&bQ.$==1?$.InsertNode(bP,bQ.$0.El,bR):bQ!=null&&bQ.$==2?(bS=bQ.$0,(bS.Dirty=false,$.InsertDoc(bP,bS.Current,bR))):bQ==null?bR:bQ!=null&&bQ.$==4?$.InsertNode(bP,bQ.$0.Text,bR):bQ!=null&&bQ.$==5?$.InsertNode(bP,bQ.$0,bR):bQ!=null&&bQ.$==6?C.foldBack(function(bT,bU){return bT==null||bT.constructor===X?$.InsertDoc(bP,bT,bU):$.InsertNode(bP,bT,bU);},bQ.$0.Els,bR):$.InsertDoc(bP,bQ.$0,$.InsertDoc(bP,bQ.$1,bR));};$.CreateRunState=function(bP,bQ){return bn.New(bo.get_Empty(),$.CreateElemNode(bP,W.EmptyAttr(),bQ));};$.PerformAnimatedUpdate=function(bP,bQ,bR){var bS;return bh.get_UseAnimations()?(bS=null,bt.Delay(function(){var bT,bU,bV;bT=bo.FindAll(bR);bU=$.ComputeChangeAnim(bQ,bT);bV=$.ComputeEnterAnim(bQ,bT);return bt.Bind(bh.Play(bh.Append(bU,$.ComputeExitAnim(bQ,bT))),function(){return bt.Bind($.SyncElemNodesNextFrame(bP,bQ),function(){return bt.Bind(bh.Play(bV),function(){bQ.PreviousNodes=bT;return bt.Return(null);});});});})):$.SyncElemNodesNextFrame(bP,bQ);};$.PerformSyncUpdate=function(bP,bQ,bR){var bS;bS=bo.FindAll(bR);$.SyncElemNode(bP,bQ.Top);bQ.PreviousNodes=bS;};$.InsertNode=function(bP,bQ,bR){V.InsertAt(bP,bR,bQ);return bQ;};$.SyncElemNodesNextFrame=function(bP,bQ){function bR(bS){a.requestAnimationFrame(function(){$.SyncElemNode(bP,bQ.Top);bS();});}return bi.BatchUpdatesEnabled()?bt.FromContinuations(function(bS,bT,bU){return bR.apply(null,[bS,bT,bU]);}):($.SyncElemNode(bP,bQ.Top),bt.Return(null));};$.ComputeExitAnim=function(bP,bQ){return bh.Concat(C.map(function(bR){return W.GetExitAnim(bR.Attr);},bo.ToArray(bo.Except(bQ,bo.Filter(function(bR){return W.HasExitAnim(bR.Attr);},bP.PreviousNodes)))));};$.ComputeEnterAnim=function(bP,bQ){return bh.Concat(C.map(function(bR){return W.GetEnterAnim(bR.Attr);},bo.ToArray(bo.Except(bP.PreviousNodes,bo.Filter(function(bR){return W.HasEnterAnim(bR.Attr);},bQ)))));};$.ComputeChangeAnim=function(bP,bQ){var bR;function bS(bT){return W.HasChangeAnim(bT.Attr);}bR=function(bT){return bo.Filter(bS,bT);};return bh.Concat(C.map(function(bT){return W.GetChangeAnim(bT.Attr);},bo.ToArray(bo.Intersect(bR(bP.PreviousNodes),bR(bQ)))));};$.SyncElemNode=function(bP,bQ){!bP?$.SyncElement(bQ):void 0;$.Sync(bQ.Children);$.AfterRender(bQ);};$.SyncElement=function(bP){function bQ(bR){function bS(bT){var bU,bV;return bT!=null&&bT.$==0?bS(bT.$0)||bS(bT.$1):bT!=null&&bT.$==2?(bU=bT.$0,bU.Dirty||bS(bU.Current)):bT!=null&&bT.$==6&&(bV=bT.$0,bV.Dirty||C.exists(bQ,bV.Holes));}return bS(bR.Children);}W.Sync(bP.El,bP.Attr);bQ(bP)?$.DoSyncElement(bP):void 0;};$.Sync=function(bP){var bQ,bR;if(bP!=null&&bP.$==1)$.SyncElemNode(false,bP.$0);else if(bP!=null&&bP.$==2)$.Sync(bP.$0.Current);else if(bP==null);else if(bP!=null&&bP.$==5);else if(bP!=null&&bP.$==4){bQ=bP.$0;bQ.Dirty?(bQ.Text.nodeValue=bQ.Value,bQ.Dirty=false):void 0;}else if(bP!=null&&bP.$==6){bR=bP.$0;C.iter(function(bS){$.SyncElemNode(false,bS);},bR.Holes);C.iter(function(bS){W.Sync(bS[0],bS[1]);},bR.Attrs);$.AfterRender(bR);}else{$.Sync(bP.$0);$.Sync(bP.$1);}};$.AfterRender=function(bP){var bQ;bQ=bM.GetOptional(bP.Render);bQ!=null&&bQ.$==1?(bQ.$0(bP.El),bM.SetOptional(bP,"Render",null)):void 0;};$.DoSyncElement=function(bP){var bQ,bR,bS;function bT(bU,bV){var bW,bX;return bU!=null&&bU.$==1?bU.$0.El:bU!=null&&bU.$==2?(bW=bU.$0,bW.Dirty?(bW.Dirty=false,$.InsertDoc(bQ,bW.Current,bV)):bT(bW.Current,bV)):bU==null?bV:bU!=null&&bU.$==4?bU.$0.Text:bU!=null&&bU.$==5?bU.$0:bU!=null&&bU.$==6?(bX=bU.$0,(bX.Dirty?bX.Dirty=false:void 0,C.foldBack(function(bY,bZ){return bY==null||bY.constructor===X?bT(bY,bZ):bY;},bX.Els,bV))):bT(bU.$0,bT(bU.$1,bV));}bQ=bP.El;bD.Iter((bR=bP.El,function(bU){V.RemoveNode(bR,bU);}),bD.Except(bD.DocChildren(bP),bD.Children(bP.El,bM.GetOptional(bP.Delimiters))));bT(bP.Children,(bS=bM.GetOptional(bP.Delimiters),bS!=null&&bS.$==1?bS.$0[1]:null));};ba.$cctor=function(){ba.$cctor=a.ignore;ba.counter=0;};bb=c.Updates=bM.Class({},null,bb);bb.Create=function(bP){var bQ;bQ=null;bQ=bb.New(bP,null,function(){var bR;bR=bQ.s;return bR===null?(bR=S.Copy(bQ.c()),bQ.s=bR,S.WhenObsoleteRun(bR,function(){bQ.s=null;}),bR):bR;});return bQ;};bb.New=function(bP,bQ,bR){return new bb({c:bP,s:bQ,v:bR});};bd.New=function(bP,bQ,bR,bS){var bT;bT={DynElem:bP,DynFlags:bQ,DynNodes:bR};bM.SetOptional(bT,"OnAfterRender",bS);return bT;};be.convertTextNode=function(bP){var bQ,bR,bS,bT,bU,bV;bQ=null;bR=0;bT=bP.textContent;bU=new a.RegExp(N.TextHoleRE(),"g");while(bQ=bU.exec(bT),bQ!==null){bP.parentNode.insertBefore(self.document.createTextNode(bf.string(bT,{$:1,$0:bR},{$:1,$0:bU.lastIndex-C.get(bQ,0).length-1})),bP);bR=bU.lastIndex;bV=self.document.createElement("span");bV.setAttribute("ws-replace",C.get(bQ,1).toLowerCase());bP.parentNode.insertBefore(bV,bP);}bU.lastIndex=0;bP.textContent=bf.string(bT,{$:1,$0:bR},null);};be.failNotLoaded=function(bP){bK.warn("Instantiating non-loaded template",bP);};be.fillTextHole=function(bP,bQ,bR){var bS;bS=bP.querySelector("[ws-replace]");return J.Equals(bS,null)?(bK.warn("Filling non-existent text hole",bR),null):(bS.parentNode.replaceChild(new a.Text(bQ),bS),{$:1,$0:bS.getAttribute("ws-replace")});};be.removeHolesExcept=function(bP,bQ){function bR(bS){V.IterSelector(bP,"["+bS+"]",function(bT){if(!bQ.Contains(bT.getAttribute(bS)))bT.removeAttribute(bS);});}bR("ws-attr");bR("ws-onafterrender");bR("ws-var");V.IterSelector(bP,"[ws-hole]",function(bS){if(!bQ.Contains(bS.getAttribute("ws-hole"))){bS.removeAttribute("ws-hole");while(bS.hasChildNodes())bS.removeChild(bS.lastChild);}});V.IterSelector(bP,"[ws-replace]",function(bS){if(!bQ.Contains(bS.getAttribute("ws-replace")))bS.parentNode.removeChild(bS);});V.IterSelector(bP,"[ws-on]",function(bS){bS.setAttribute("ws-on",bl.concat(" ",C.filter(function(bT){return bQ.Contains(C.get(bl.SplitChars(bT,[":"],1),1));},bl.SplitChars(bS.getAttribute("ws-on"),[" "],1))));});V.IterSelector(bP,"[ws-attr-holes]",function(bS){var bT,bU,bV,bW,bX;bT=bl.SplitChars(bS.getAttribute("ws-attr-holes"),[" "],1);for(bU=0,bV=bT.length-1;bU<=bV;bU++){bW=C.get(bT,bU);bS.setAttribute(bW,(bX=new a.RegExp(N.TextHoleRE(),"g"),bS.getAttribute(bW).replace(bX,function(bY,bZ){return bQ.Contains(bZ)?bY:"";})));}});};be.fillInstanceAttrs=function(bP,bQ){var bR,bS,bT,bU,bV;be.convertAttrs(bQ);bR=bQ.nodeName.toLowerCase();bS=bP.querySelector("[ws-attr="+bR+"]");if(J.Equals(bS,null))bK.warn("Filling non-existent attr hole",bR);else{bS.removeAttribute("ws-attr");for(bT=0,bU=bQ.attributes.length-1;bT<=bU;bT++){bV=bQ.attributes.item(bT);bV.name==="class"&&bS.hasAttribute("class")?bS.setAttribute("class",bS.getAttribute("class")+" "+bV.nodeValue):bS.setAttribute(bV.name,bV.nodeValue);}}};be.mapHoles=function(bP,bQ){function bR(bS){V.IterSelector(bP,"["+bS+"]",function(bT){var bU,bV;bU=(bV=null,[bQ.TryGetValue(bT.getAttribute(bS).toLowerCase(),{get:function(){return bV;},set:function(bW){bV=bW;}}),bV]);bU[0]?bT.setAttribute(bS,bU[1]):void 0;});}bR("ws-hole");bR("ws-replace");bR("ws-attr");bR("ws-onafterrender");bR("ws-var");V.IterSelector(bP,"[ws-on]",function(bS){bS.setAttribute("ws-on",bl.concat(" ",C.map(function(bT){var bU,bV,bW;bU=bl.SplitChars(bT,[":"],1);bV=(bW=null,[bQ.TryGetValue(C.get(bU,1),{get:function(){return bW;},set:function(bX){bW=bX;}}),bW]);return bV[0]?C.get(bU,0)+":"+bV[1]:bT;},bl.SplitChars(bS.getAttribute("ws-on"),[" "],1))));});V.IterSelector(bP,"[ws-attr-holes]",function(bS){var bT,bU,bV;bT=bl.SplitChars(bS.getAttribute("ws-attr-holes"),[" "],1);for(bU=0,bV=bT.length-1;bU<=bV;bU++)(function(){var bW;function bX(bY,bZ){var b0;b0=i.KeyValue(bZ);return bY.replace(new a.RegExp("\\${"+b0[0]+"}","ig"),"${"+b0[1]+"}");}bW=C.get(bT,bU);return bS.setAttribute(bW,(((bM.Curried3(n.fold))(bX))(bS.getAttribute(bW)))(bQ));}());});};be.fill=function(bP,bQ,bR){while(true)if(bP.hasChildNodes())bR=bQ.insertBefore(bP.lastChild,bR);else return null;};be.convertAttrs=function(bP){var bR,bS,bT,bU,bV,bW,bX,bY;function bQ(bZ){var b0;b0=bP.getAttribute(bZ);b0===null?void 0:bP.setAttribute(bZ,b0.toLowerCase());}bR=bP.attributes;bS=[];bT=[];bU=[];for(bV=0,bW=bR.length-1;bV<=bW;bV++){bX=bR.item(bV);bl.StartsWith(bX.nodeName,"ws-on")&&bX.nodeName!=="ws-onafterrender"&&bX.nodeName!=="ws-on"?(bS.push(bX.nodeName),bT.push(bf.string(bX.nodeName,{$:1,$0:"ws-on".length},null)+":"+bX.nodeValue.toLowerCase())):!bl.StartsWith(bX.nodeName,"ws-")&&(new a.RegExp(N.TextHoleRE())).test(bX.nodeValue)?(bX.nodeValue=(bY=new a.RegExp(N.TextHoleRE(),"g"),bX.nodeValue.replace(bY,function(bZ,b0){return"${"+b0.toLowerCase()+"}";})),bU.push(bX.nodeName)):void 0;}!(bT.length==0)?bP.setAttribute("ws-on",bl.concat(" ",bT)):void 0;!(bU.length==0)?bP.setAttribute("ws-attr-holes",bl.concat(" ",bU)):void 0;bQ("ws-hole");bQ("ws-replace");bQ("ws-attr");bQ("ws-onafterrender");bQ("ws-var");C.iter(function(bZ){bP.removeAttribute(bZ);},bS);};bf.string=function(bP,bQ,bR){return bQ==null?bR!=null&&bR.$==1?bP.slice(0,bR.$0+1):"":bR==null?bP.slice(bQ.$0):bP.slice(bQ.$0,bR.$0+1);};n.insufficient=function(){return i.FailWith("The input sequence has an insufficient number of elements.");};bg=T.KeyCollection=bM.Class({GetEnumerator$1:function(){return H.Get(n.map(function(bP){return bP.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},l,bg);bg.New=bM.Ctor(function(bP){l.New.call(this);this.d=bP;},bg);bh.get_UseAnimations=function(){return bp.UseAnimations();};bh.Play=function(bP){var bQ;bQ=null;return bt.Delay(function(){return bt.Bind(bh.Run(a.ignore,bp.Actions(bP)),function(){bp.Finalize(bP);return bt.Return(null);});});};bh.Append=function(bP,bQ){return{$:0,$0:bu.Append(bP.$0,bQ.$0)};};bh.Run=function(bP,bQ){var bR;function bS(bT){function bU(bV,bW){var bX;bX=bW-bV;bQ.Compute(bX);bP();return bX<=bR?void a.requestAnimationFrame(function(bY){bU(bV,bY);}):bT();}a.requestAnimationFrame(function(bV){bU(bV,bV);});}bR=bQ.Duration;return bR===0?bt.Zero():bt.FromContinuations(function(bT,bU,bV){return bS.apply(null,[bT,bU,bV]);});};bh.Concat=function(bP){return{$:0,$0:bu.Concat(n.map(bp.List,bP))};};bh.get_Empty=function(){return{$:0,$0:bu.Empty()};};bi.BatchUpdatesEnabled=function(){bq.$cctor();return bq.BatchUpdatesEnabled;};bj.StartProcessor=function(bP){var bQ;function bR(){var bS;bS=null;return bt.Delay(function(){return bt.Bind(bP,function(){var bT;bT=bQ[0];return bT===1?(bQ[0]=0,bt.Zero()):bT===2?(bQ[0]=1,bR()):bt.Zero();});});}bQ=[0];return function(){var bS;bS=bQ[0];bS===0?(bQ[0]=1,bt.Start(bR(),null)):bS===1?bQ[0]=2:void 0;};};bk.$cctor=function(){bk.$cctor=a.ignore;bk.EmptyAttr=null;};bl.concat=function(bP,bQ){return C.ofSeq(bQ).join(bP);};bl.SplitChars=function(bP,bQ,bR){return bl.Split(bP,new a.RegExp("["+bl.RegexEscape(bQ.join(""))+"]"),bR);};bl.StartsWith=function(bP,bQ){return bP.substring(0,bQ.length)==bQ;};bl.Split=function(bP,bQ,bR){return bR===1?C.filter(function(bS){return bS!=="";},bl.SplitWith(bP,bQ)):bl.SplitWith(bP,bQ);};bl.RegexEscape=function(bP){return bP.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bl.SplitWith=function(bP,bQ){return bP.split(bQ);};bn.New=function(bP,bQ){return{PreviousNodes:bP,Top:bQ};};bo.get_Empty=function(){return{$:0,$0:new _8.New$3()};};bo.FindAll=function(bP){var bQ;function bR(bT){if(bT!=null&&bT.$==0){bR(bT.$0);bR(bT.$1);}else if(bT!=null&&bT.$==1)bS(bT.$0);else if(bT!=null&&bT.$==2)bR(bT.$0.Current);else if(bT!=null&&bT.$==6)C.iter(bS,bT.$0.Holes);}function bS(bT){bQ.push(bT);bR(bT.Children);}bQ=[];bR(bP);return{$:0,$0:new _8.New$2(bQ)};};bo.Filter=function(bP,bQ){return{$:0,$0:bA.Filter(bP,bQ.$0)};};bo.Except=function(bP,bQ){return{$:0,$0:bA.Except(bP.$0,bQ.$0)};};bo.ToArray=function(bP){return bA.ToArray(bP.$0);};bo.Intersect=function(bP,bQ){return{$:0,$0:bA.Intersect(bP.$0,bQ.$0)};};bp.UseAnimations=function(){bs.$cctor();return bs.UseAnimations;};bp.Actions=function(bP){return bp.ConcatActions(C.choose(function(bQ){return bQ.$==1?{$:1,$0:bQ.$0}:null;},bu.ToArray(bP.$0)));};bp.Finalize=function(bP){C.iter(function(bQ){if(bQ.$==0)bQ.$0();},bu.ToArray(bP.$0));};bp.ConcatActions=function(bP){var bQ,bR,bS,bT;bQ=K.ofSeqNonCopying(bP);bR=C.length(bQ);return bR===0?bp.Const():bR===1?C.get(bQ,0):(bS=n.max(n.map(function(bU){return bU.Duration;},bQ)),(bT=C.map(function(bU){return bp.Prolong(bS,bU);},bQ),bp.Def(bS,function(bU){C.iter(function(bV){bV.Compute(bU);},bT);})));};bp.List=function(bP){return bP.$0;};bp.Const=function(bP){return bp.Def(0,function(){return bP;});};bp.Def=function(bP,bQ){return{Compute:bQ,Duration:bP};};bp.Prolong=function(bP,bQ){var bR,bS,bT;bR=bQ.Compute;bS=bQ.Duration;bT=bG.Create(function(){return bQ.Compute(bQ.Duration);});return{Compute:function(bU){return bU>=bS?bT.f():bR(bU);},Duration:bP};};bq.$cctor=function(){bq.$cctor=a.ignore;bq.BatchUpdatesEnabled=true;};br.Clear=function(bP){bP.splice(0,C.length(bP));};bs.$cctor=function(){bs.$cctor=a.ignore;bs.CubicInOut=bw.Custom(function(bP){var bQ;bQ=bP*bP;return 3*bQ-2*(bQ*bP);});bs.UseAnimations=true;};bt.Delay=function(bP){return function(bQ){try{(bP(null))(bQ);}catch(bR){bQ.k({$:1,$0:bR});}};};bt.Bind=function(bP,bQ){return bt.checkCancel(function(bR){bP(bx.New(function(bS){var bT;if(bS.$==0){bT=bS.$0;bt.scheduler().Fork(function(){try{(bQ(bT))(bR);}catch(bU){bR.k({$:1,$0:bU});}});}else bt.scheduler().Fork(function(){bR.k(bS);});},bR.ct));});};bt.Zero=function(){by.$cctor();return by.Zero;};bt.Start=function(bP,bQ){var bR,bS;bR=(bS=(bt.defCTS())[0],bQ==null?bS:bQ.$0);bt.scheduler().Fork(function(){if(!bR.c)bP(bx.New(function(bT){if(bT.$==1)bt.UncaughtAsyncError(bT.$0);},bR));});};bt.Return=function(bP){return function(bQ){bQ.k({$:0,$0:bP});};};bt.checkCancel=function(bP){return function(bQ){if(bQ.ct.c)bt.cancel(bQ);else bP(bQ);};};bt.defCTS=function(){by.$cctor();return by.defCTS;};bt.UncaughtAsyncError=function(bP){bK.log("WebSharper: Uncaught asynchronous exception",bP);};bt.FromContinuations=function(bP){return function(bQ){var bR;function bS(bT){if(bR[0])i.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bR[0]=true;bt.scheduler().Fork(bT);}}bR=[false];bP(function(bT){bS(function(){bQ.k({$:0,$0:bT});});},function(bT){bS(function(){bQ.k({$:1,$0:bT});});},function(bT){bS(function(){bQ.k({$:2,$0:bT});});});};};bt.cancel=function(bP){bP.k({$:2,$0:new bF.New(bP.ct)});};bt.scheduler=function(){by.$cctor();return by.scheduler;};bu.Append=function(bP,bQ){return bP.$==0?bQ:bQ.$==0?bP:{$:2,$0:bP,$1:bQ};};bu.ToArray=function(bP){var bQ;function bR(bS){if(bS.$==1)bQ.push(bS.$0);else if(bS.$==2){bR(bS.$0);bR(bS.$1);}else if(bS.$==3)C.iter(function(bT){bQ.push(bT);},bS.$0);}bQ=[];bR(bP);return bQ.slice(0);};bu.Concat=function(bP){var bQ;bQ=K.ofSeqNonCopying(bP);return K.TreeReduce(bu.Empty(),bu.Append,bQ);};bu.Empty=function(){bH.$cctor();return bH.Empty;};bv.concat=function(bP){var bQ,bR;bQ=[];for(var bS in bP)bQ.push.apply(bQ,bP[bS]);return bQ;};bw=c.Easing=bM.Class({},l,bw);bw.Custom=function(bP){return new bw.New(bP);};bw.New=bM.Ctor(function(bP){l.New.call(this);this.transformTime=bP;},bw);bx.New=function(bP,bQ){return{k:bP,ct:bQ};};by.$cctor=function(){by.$cctor=a.ignore;by.noneCT=bz.New(false,[]);by.scheduler=new bB.New();by.defCTS=[new bC.New()];by.Zero=bt.Return();by.GetCT=function(bP){bP.k({$:0,$0:bP.ct});};};bz.New=function(bP,bQ){return{c:bP,r:bQ};};bA.Filter=function(bP,bQ){return new _8.New$2(C.filter(bP,bA.ToArray(bQ)));};bA.Except=function(bP,bQ){var bR;bR=new _8.New$2(bA.ToArray(bQ));bR.ExceptWith(bA.ToArray(bP));return bR;};bA.ToArray=function(bP){var bQ;bQ=C.create(bP.get_Count(),void 0);bP.CopyTo(bQ);return bQ;};bA.Intersect=function(bP,bQ){var bR;bR=new _8.New$2(bA.ToArray(bP));bR.IntersectWith(bA.ToArray(bQ));return bR;};bB=bt.Scheduler=bM.Class({Fork:function(bP){var bQ;bQ=this;this.robin.push(bP);this.idle?(this.idle=false,a.setTimeout(function(){bQ.tick();},0)):void 0;},tick:function(){var bP,bQ,bR;bQ=this;bR=bO.now();bP=true;while(bP)if(this.robin.length===0){this.idle=true;bP=false;}else{(this.robin.shift())();bO.now()-bR>40?(a.setTimeout(function(){bQ.tick();},0),bP=false):void 0;}}},l,bB);bB.New=bM.Ctor(function(){l.New.call(this);this.idle=true;this.robin=[];},bB);bC=b.CancellationTokenSource=bM.Class({},l,bC);bC.New=bM.Ctor(function(){l.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bC);bD.Children=function(bP,bQ){var bR,bS,bT;if(bQ!=null&&bQ.$==1){bT=[];bR=bQ.$0[0].nextSibling;while(bR!==bQ.$0[1]){bT.push(bR);bR=bR.nextSibling;}return{$:0,$0:bT};}else return{$:0,$0:C.init(bP.childNodes.length,(bS=bP.childNodes,function(bU){return bS[bU];}))};};bD.Except=function(bP,bQ){var bR;bR=bP.$0;return{$:0,$0:C.filter(function(bS){return C.forall(function(bT){return!(bS===bT);},bR);},bQ.$0)};};bD.Iter=function(bP,bQ){C.iter(bP,bQ.$0);};bD.DocChildren=function(bP){var bQ;function bR(bS){if(bS!=null&&bS.$==2)bR(bS.$0.Current);else if(bS!=null&&bS.$==1)bQ.push(bS.$0.El);else if(bS==null);else if(bS!=null&&bS.$==5)bQ.push(bS.$0);else if(bS!=null&&bS.$==4)bQ.push(bS.$0.Text);else if(bS!=null&&bS.$==6)C.iter(function(bT){if(bT==null||bT.constructor===X)bR(bT);else bQ.push(bT);},bS.$0.Els);else{bR(bS.$0);bR(bS.$1);}}bQ=[];bR(bP.Children);return{$:0,$0:K.ofSeqNonCopying(bQ)};};bF=b.OperationCanceledException=bM.Class({},bE,bF);bF.New=bM.Ctor(function(bP){bF.New$1.call(this,"The operation was canceled.",null,bP);},bF);bF.New$1=bM.Ctor(function(bP,bQ,bR){this.message=bP;this.inner=bQ;X.setPrototypeOf(this,bF.prototype);this.ct=bR;},bF);bG.Create=function(bP){return bJ.New(false,bP,bG.forceLazy);};bG.forceLazy=function(){var bP;bP=this.v();this.c=true;this.v=bP;this.f=bG.cachedLazy;return bP;};bG.cachedLazy=function(){return this.v;};bH.$cctor=function(){bH.$cctor=a.ignore;bH.Empty={$:0};};bJ.New=function(bP,bQ,bR){return{c:bP,v:bQ,f:bR};};bM.OnLoad(function(){f.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
